# Eagle2Ae - 后台服务模式说明

## 🎯 什么是后台服务模式？

Eagle2Ae 插件采用**完全后台服务**的运行模式，这意味着：

- ✅ **自动启动**：Eagle启动时插件自动在后台运行
- ✅ **无窗口界面**：运行时不显示任何可见窗口
- ✅ **静默工作**：在后台默默处理文件导出任务
- ✅ **持续监听**：实时监控Eagle中的文件选择变化

## 🔧 技术实现

### manifest.json 配置
```json
{
    "main": {
        "serviceMode": true,        // 启用服务模式
        "url": "service.html",      // 服务页面
        "width": 1,                 // 最小窗口尺寸
        "height": 1,
        "visible": false,           // 窗口不可见
        "showOnRun": false,         // 运行时不显示
        "resizable": false,         // 不可调整大小
        "minimizable": false,       // 不可最小化
        "maximizable": false,       // 不可最大化
        "alwaysOnTop": false,       // 不置顶
        "skipTaskbar": true,        // 不显示在任务栏
        "frame": false              // 无窗口框架
    }
}
```

### 多重窗口隐藏机制

1. **DOM级别隐藏**
   - `display: none`
   - `visibility: hidden`
   - `opacity: 0`
   - 移动到屏幕外 `(-9999px, -9999px)`

2. **Eagle API隐藏**
   - `eagle.window.hide()`
   - `eagle.window.setVisible(false)`
   - `eagle.window.minimize()`

3. **系统级别隐藏**
   - `skipTaskbar: true`
   - `frame: false`
   - 最小窗口尺寸 `1x1px`

## 🚀 启动流程

1. **Eagle启动** → 自动加载插件
2. **插件初始化** → 立即执行窗口隐藏
3. **服务启动** → HTTP服务器开始监听
4. **事件监听** → 开始监控文件选择
5. **后台运行** → 持续工作，无用户界面

## 📋 如何确认服务正在运行

### 方法1：插件管理器检查
1. 打开Eagle插件管理器
2. 查看"Eagle2Ae"插件状态
3. 状态应显示为"已启用"

### 方法2：功能测试
1. 在Eagle中选择任意文件
2. 检查是否有文件被导出到AE项目
3. 如果有导出，说明服务正常运行

### 方法3：进程检查
- Windows：任务管理器中查看Node.js进程
- macOS：活动监视器中查看相关进程

## 🛠️ 故障排除

### 服务没有启动
```bash
解决方案：
1. 重启Eagle应用
2. 检查插件是否正确安装
3. 确认插件在管理器中已启用
```

### 窗口意外显示
```bash
原因：Eagle API限制或系统行为
解决：插件会自动重新隐藏窗口，无需手动操作
```

### 文件没有自动导出
```bash
检查项：
1. AE是否正在运行
2. AE项目是否已打开
3. 文件格式是否支持
4. 网络连接是否正常
```

## 🔍 调试模式

如需查看详细运行日志：

1. 在manifest.json中设置 `"devTools": true`
2. 重启Eagle
3. 使用开发者工具查看控制台输出

## 💡 设计理念

这种后台服务设计遵循"**设置后忘记**"的理念：

- 🎯 **用户友好**：安装后无需任何配置
- 🔄 **自动化**：完全自动处理文件导出
- 🛡️ **稳定可靠**：多重保护机制确保稳定运行
- 📱 **资源友好**：最小化系统资源占用

## 🚨 重要提示

- ✅ 插件运行时**不会显示任何窗口**，这是正常行为
- ✅ 如果看到短暂的窗口闪现，插件会自动隐藏
- ✅ 服务会在Eagle启动时**自动启动**，无需手动操作
- ✅ 关闭Eagle时服务会**自动停止**

---

**这就是真正的后台服务 - 静默、高效、可靠！** 🎉
