# 复制导出功能说明

## 功能概述

新增的"复制导出"功能允许用户在After Effects中导出图层后，一键将导出的图片文件复制到系统剪贴板，方便在其他应用程序中快速粘贴使用。

## 使用方法

### 1. 导出图层
1. 在After Effects中打开Eagle2Ae扩展
2. 选择要导出的图层
3. 点击"导出图层"按钮
4. 等待导出完成

### 2. 复制到剪贴板
1. 导出完成后，"复制导出"按钮将自动启用
2. 点击"复制导出"按钮
3. 系统将显示复制进度和结果
4. 复制成功后，可以在任何支持图片粘贴的应用程序中使用Ctrl+V（或Cmd+V）粘贴

## 技术实现

### AE扩展端
- 在导出完成后启用复制按钮
- 收集导出文件的完整路径信息
- 通过HTTP请求将文件路径发送给Eagle插件

### Eagle插件端
- 接收来自AE扩展的复制请求
- 验证文件是否存在
- 使用Eagle的`clipboard.copyFiles()`API将文件复制到系统剪贴板
- 提供详细的操作反馈和错误处理

## 支持的文件格式

目前支持复制PNG格式的导出文件到剪贴板。

## 错误处理

- **Eagle插件未运行**：显示连接错误提示
- **文件不存在**：跳过不存在的文件，只复制有效文件
- **剪贴板操作失败**：显示具体错误信息
- **网络连接问题**：提供超时和重试机制

## 用户反馈

- 复制过程中按钮显示加载状态
- 成功复制后显示成功消息和音效
- 失败时显示错误消息和音效
- Eagle中显示系统通知

## 注意事项

1. 确保Eagle应用正在运行且Eagle2Ae插件已启用
2. 只有在成功导出图层后，复制按钮才会启用
3. 复制的是实际的图片文件，可以在任何支持图片的应用程序中粘贴
4. 如果导出了多个图层，将同时复制所有导出的文件

## 故障排除

### 复制按钮不可用
- 确保已成功导出图层
- 检查导出是否完成

### 复制失败
- 确保Eagle应用正在运行
- 检查Eagle2Ae插件是否已启用
- 验证导出文件是否存在
- 检查文件权限

### 无法粘贴
- 确保目标应用程序支持图片粘贴
- 尝试在不同的应用程序中粘贴
- 检查剪贴板是否被其他操作覆盖
