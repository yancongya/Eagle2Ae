# “导入模式”设置功能逻辑

## 1. 概述

“导入模式”设置面板组用于定义文件从Eagle导入到After Effects时的核心处理方式，主要涉及文件的**存放位置**和**链接方式**。这些设置是确保项目文件管理一致性和便携性的关键。

此设置遵循**即时保存**机制，任何修改都会被立即持久化，并与主面板的快速设置保持同步。

## 2. 功能组件详解

面板上提供了三种核心导入模式，它们决定了素材文件在导入AE项目之前的物理文件操作。

### 2.1 直接导入 (Direct Import)

- **UI 标签**: `直接导入`
- **内部值**: `direct`
- **工作方式**: 此模式直接使用Eagle素材库中的原始文件路径进行导入。**不会发生任何文件的复制或移动**。
- **优点**:
    - **速度最快**: 没有文件I/O开销，导入过程非常迅速。
    - **节省空间**: 不会产生重复的文件副本。
- **缺点**:
    - **链接风险**: 如果Eagle库中的原始文件被移动、重命名或删除，AE项目中的素材链接将会丢失，导致素材“变红”。
    - **协作困难**: 不适用于团队协作，除非所有成员都能访问完全相同的Eagle库路径（例如通过配置一致的网络驱动器）。
- **适用场景**: 个人项目、临时项目，或者用户有非常规范和稳定的文件管理流程。

### 2.2 项目旁复制 (Project Adjacent)

- **UI 标签**: `项目旁复制`
- **内部值**: `project_adjacent`
- **工作方式**: 此模式是**默认且最推荐的选项**。它会将文件从Eagle库**复制**到当前AE项目文件（`.aep`）旁边的一个指定子文件夹中，然后再执行导入。
- **文件操作流程**:
    1.  检查当前AE项目是否已保存。如果未保存，流程将中止并提示用户。
    2.  获取项目文件所在目录。
    3.  根据用户设置（默认为 `Eagle_Assets`），在该目录下创建这个子文件夹（如果尚不存在）。
    4.  将文件从Eagle库路径**复制**到这个新的子文件夹中。
    5.  使用**复制后**的新文件路径进行导入。
- **优点**:
    - **项目自包含**: 所有导入的素材都与 `.aep` 文件存储在一起，便于项目归档、迁移和团队协作。
    - **链接稳定**: 只要整个项目文件夹被移动，素材链接就不会丢失。
- **缺点**:
    - **占用额外空间**: 每个导入的文件都会创建一个副本。
    - **导入稍慢**: 因为涉及文件复制操作，所以比“直接导入”耗时。
- **适用场景**: 绝大多数标准工作流程，特别是团队协作和需要长期维护的项目。

### 2.3 指定文件夹 (Custom Folder)

- **UI 标签**: `指定文件夹`
- **内部值**: `custom_folder`
- **工作方式**: 此模式会将所有文件**复制**到一个用户预先设定的、固定的全局文件夹中，然后再执行导入。
- **文件操作流程**:
    1.  从设置中获取用户设定的目标文件夹路径。
    2.  如果该文件夹不存在，系统会尝试创建它。
    3.  将文件从Eagle库路径**复制**到这个指定的目标文件夹中。
    4.  使用**复制后**的新文件路径进行导入。
- **优点**:
    - **集中管理**: 所有通过此插件导入的素材都被集中存放在一个地方，便于统一管理或清理。
    - **路径可预测**: 导入后的素材路径是固定的，便于其他工具或脚本进行交互。
- **缺点**:
    - **项目分散**: 素材文件与 `.aep` 项目文件物理上是分离的，归档和迁移项目时需要同时处理项目文件和这个全局素材文件夹。
- **适用场景**: 用户希望将所有外部导入的素材与项目文件分离，并进行集中化管理。

## 3. 逻辑流程与数据持久化

1.  **事件监听**: `main.js` 中的 `setupSettingsPanel` 方法为所有模式的单选按钮绑定了 `change` 事件监听器。

2.  **数据保存**: 当用户切换模式时，会触发回调函数，该函数立即调用 `settingsManager.updateField('mode', radio.value)`，将新的模式值（如 `'project_adjacent'`）实时保存到 `localStorage` 中。

3.  **配置交互**: 如果选择“项目旁复制”或“指定文件夹”，通常会触发一个配置对话框，让用户设置文件夹名称或路径。这些额外配置也会被 `SettingsManager` 一并保存。
