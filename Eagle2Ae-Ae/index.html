<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Eagle2AE</title>
    <link rel="icon" type="image/png" href="public/logo.png">

    <!-- Node.js åˆå§‹åŒ–è„šæœ¬ -->
    <script type="text/javascript">
        // Node.jsç¯å¢ƒæ£€æµ‹å’Œåˆå§‹åŒ– (åŸºäºCEPå®˜æ–¹æ–‡æ¡£)
        (function() {
            console.log('ğŸ” å¼€å§‹æ£€æµ‹Node.jsç¯å¢ƒ...');
            console.log('CEPç¯å¢ƒä¿¡æ¯:', {
                cep: typeof cep,
                __adobe_cep__: typeof __adobe_cep__,
                cep_node: typeof cep_node,
                require: typeof require,
                process: typeof process
            });

            // åˆå§‹åŒ–æ ‡å¿—
            window.__NODE_JS_AVAILABLE__ = false;

            // æ–¹æ³•1: æ£€æŸ¥cep_nodeå¯¹è±¡ (CEP 8+å®˜æ–¹æ¨èæ–¹å¼)
            if (typeof cep_node !== 'undefined') {
                console.log('âœ… æ£€æµ‹åˆ° cep_node å¯¹è±¡ (CEP 8+)');
                try {
                    // æ ¹æ®å®˜æ–¹æ–‡æ¡£ï¼Œcep_nodeåŒ…å«: Buffer, global, process, require
                    window.require = cep_node.require;
                    window.Buffer = cep_node.Buffer;
                    window.process = cep_node.process;
                    window.global = cep_node.global;

                    // æµ‹è¯•requireæ˜¯å¦å·¥ä½œ
                    const os = window.require('os');
                    if (os) {
                        console.log('âœ… Node.jsç¯å¢ƒå·²é€šè¿‡cep_nodeåˆå§‹åŒ–');
                        console.log('Node.jsç‰ˆæœ¬:', window.process.version);
                        console.log('å¹³å°:', os.platform());
                        window.__NODE_JS_AVAILABLE__ = true;
                        return;
                    }
                } catch (error) {
                    console.warn('âš ï¸ cep_nodeåˆå§‹åŒ–å¤±è´¥:', error.message);
                }
            }

            // æ–¹æ³•2: æ£€æŸ¥CEPå¯¹è±¡çš„processå±æ€§ (CEPæä¾›çš„åŸç”ŸAPI)
            if (typeof cep !== 'undefined' && cep.process) {
                console.log('âœ… æ£€æµ‹åˆ° cep.process (CEPåŸç”ŸAPI)');
                try {
                    window.process = cep.process;

                    // CEPå¯èƒ½æä¾›fsç­‰API
                    if (cep.fs) {
                        window.cepfs = cep.fs;
                        console.log('âœ… cep.fså¯ç”¨');
                    }

                    console.log('âœ… Node.jsç¯å¢ƒå·²é€šè¿‡cepå¯¹è±¡åˆå§‹åŒ–');
                    console.log('å¹³å°:', window.process.platform || 'unknown');
                    window.__NODE_JS_AVAILABLE__ = true;
                    return;
                } catch (error) {
                    console.warn('âš ï¸ cepå¯¹è±¡åˆå§‹åŒ–å¤±è´¥:', error.message);
                }
            }

            // æ–¹æ³•3: æ£€æŸ¥å…¨å±€require (ä¼ ç»Ÿæ–¹å¼)
            if (typeof require !== 'undefined') {
                console.log('âœ… æ£€æµ‹åˆ°å…¨å±€requireå‡½æ•°');
                try {
                    window.require = require;
                    const testModule = require('os');
                    if (testModule) {
                        console.log('âœ… Node.jsç¯å¢ƒå·²é€šè¿‡å…¨å±€requireåˆå§‹åŒ–');
                        window.__NODE_JS_AVAILABLE__ = true;
                        return;
                    }
                } catch (error) {
                    console.warn('âš ï¸ å…¨å±€requireæµ‹è¯•å¤±è´¥:', error.message);
                }
            }

            // æ–¹æ³•4: æ£€æŸ¥å…¨å±€processå¯¹è±¡
            if (typeof process !== 'undefined' && process.versions) {
                console.log('âœ… æ£€æµ‹åˆ°å…¨å±€processå¯¹è±¡');
                try {
                    window.process = process;
                    console.log('âœ… Node.jsç¯å¢ƒå·²é€šè¿‡å…¨å±€processåˆå§‹åŒ–');
                    console.log('Node.jsç‰ˆæœ¬:', process.version);
                    window.__NODE_JS_AVAILABLE__ = true;
                    return;
                } catch (error) {
                    console.warn('âš ï¸ å…¨å±€processåˆå§‹åŒ–å¤±è´¥:', error.message);
                }
            }

            // æ‰€æœ‰æ–¹æ³•éƒ½å¤±è´¥
            console.error('âŒ Node.jsç¯å¢ƒä¸å¯ç”¨');
            console.log('ğŸ” å¯èƒ½çš„åŸå› :');
            console.log('1. manifest.xmlä¸­ç¼ºå°‘--enable-nodejså‚æ•°');
            console.log('2. CEPç‰ˆæœ¬ä¸æ”¯æŒNode.js');
            console.log('3. éœ€è¦å¯ç”¨CEPè°ƒè¯•æ¨¡å¼');
            console.log('4. After Effectsç‰ˆæœ¬è¿‡æ–°ï¼ŒNode.jsé›†æˆæ–¹å¼å·²æ”¹å˜');

            window.__NODE_JS_AVAILABLE__ = false;
        })();
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            font-size: 12px;
            background: #383838;
            color: #e0e0e0;
            margin: 0;
            padding: 0;
            line-height: 1.4;
        }

        .panel {
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .content {
            flex: 1;
            overflow-y: auto;
            padding: 8px;
            margin-top: 68px; /* ä¸ºå›ºå®šæ ‡é¢˜æ ç•™å‡ºç©ºé—´ (8px top + 48px height + 12px margin) */
        }

        .header {
            background: #2a2a2a;
            padding: 12px;
            border-radius: 6px;
            border: 1px solid #555;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: fixed;
            top: 12px;
            left: 12px;
            right: 12px;
            z-index: 1000;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .title {
            font-size: 14px;
            font-weight: 600;
            color: #9966cc;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            transition: all 0.3s ease;

            min-width: 200px;
            overflow: visible;
            width: auto;
        }

        .title-text {
            display: flex;
            position: relative;
            min-width: 140px;
            width: auto;
            overflow: visible;
            white-space: nowrap;
        }

        .char {
            display: inline-block;
            transition: all 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            position: relative;
            flex-shrink: 0;
            margin: 0 1.5px;
            color: #9966cc;
        }

        /* ç¡®ä¿char-a1åœ¨æ­£å¸¸çŠ¶æ€ä¸‹æ˜¾ç¤º - ä½¿ç”¨æ›´é«˜ä¼˜å…ˆçº§ */
        .title .char-a1 {
            color: #9966cc !important;
        }
        
        /* éæ‚¬æµ®çŠ¶æ€ä¸‹ç¡®ä¿æ‰€æœ‰å­—ç¬¦å¯è§ */
        .title .char {
            color: #9966cc;
        }
        
        /* uppercaseç±»æ§åˆ¶å­—ç¬¦å¤§å°å†™çŠ¶æ€ */
        .char-a1.uppercase {
            text-transform: uppercase !important;
        }
        
        /* ç¦ç”¨åŠ¨ç”»å¹²æ‰° */
        .char-a1.uppercase {
            animation: none !important;
        }

        /* æ‚¬æµ®æ—¶å­—ç¬¦é‡æ–°æ’åˆ—åŠ¨ç”» - Eagle2Ae -> Ae2Eagle */
        .title:hover .char-a2 { order: 1; } /* A -> ä½ç½®1 */
        .title:hover .char-e3 { order: 2; } /* e -> ä½ç½®2 */
        .title:hover .char-2 { order: 3; }  /* 2 -> ä½ç½®3 */
        .title:hover .char-e1 { order: 4; } /* E -> ä½ç½®4 */
        .title:hover .char-a1 { order: 5; } /* a -> ä½ç½®5 (å˜æˆA) */
        .title:hover .char-g1 { order: 6; } /* g -> ä½ç½®6 */
        .title:hover .char-l1 { order: 7; } /* l -> ä½ç½®7 */
        .title:hover .char-e2 { order: 8; } /* e -> ä½ç½®8 */

        /* å­—ç¬¦å˜æ¢åŠ¨ç”» - å°å†™aå˜æˆå¤§å†™A */
        .title:hover .char-a1 {
            animation: charSwap 0.6s ease;
        }

        @keyframes charSwap {
            0% {
                opacity: 0;
                transform: scale(0.5) rotateY(90deg);
            }
            50% {
                transform: scale(1.2) rotateY(0deg);
            }
            100% {
                opacity: 1;
                transform: scale(1) rotateY(0deg);
            }
        }



        /* ç»Ÿä¸€çš„æ‚¬æµ®äº¤äº’æ•ˆæœ - æ‚¬æµ®æ•´ä¸ªæ ‡é¢˜åŒºåŸŸæ—¶ */
        .title:hover {
            color: #4a90e2;
        }

        .title:hover .title-logo {
            content: url('public/logo2.png');
            transform: scale(1.1);
        }



        .title-logo {
            width: 28px;
            height: 28px;
            object-fit: contain;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        /* é¡¶éƒ¨å›¾æ ‡æŒ‰é’®æ ·å¼ */
        .header-actions {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .icon-btn {
            background: #3a3a3a;
            color: #e0e0e0;
            border: 1px solid #555;
            border-radius: 4px;
            padding: 6px 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 32px;
            height: 28px;
        }

        .icon-btn:hover {
            background: #4a4a4a;
            border-color: #666;
        }

        .icon-btn:active {
            background: #2a2a2a;
        }

        .icon-btn .icon {
            font-size: 14px;
            line-height: 1;
        }

        /* è°ƒè¯•æµ‹è¯•æŒ‰é’®ç‰¹æ®Šæ ·å¼ */
        #debug-test-btn {
            background: #3d4a2d;
            border-color: #6a7c4a;
        }

        #debug-test-btn:hover {
            background: #4d5a3d;
            border-color: #7a8c5a;
        }

        /* é¡¹ç›®ä¿¡æ¯é¢æ¿å¤´éƒ¨æ ·å¼ */
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            height: 20px;
            min-height: 20px;
        }

        /* é¡¹ç›®ä¿¡æ¯é¢æ¿å¸ƒå±€ */
        .project-info-container {
            display: flex;
            gap: 15px;
            align-items: flex-start;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 6px;
            padding: 12px;
            border: 1px solid rgba(255, 255, 255, 0.08);
            min-width: 0; /* å…è®¸flexå­é¡¹æ”¶ç¼© */
        }

        .project-info {
            flex: 1;
            font-size: 11px;
            color: #bbb;
            line-height: 1.7;
            min-width: 0; /* å…è®¸æ”¶ç¼© */
            max-width: 50%; /* ç¡®ä¿ä¸è¶…è¿‡ä¸€åŠ */
        }

        .project-info .ae-title {
            color: #9966cc;
            font-weight: 700;
            margin-bottom: 8px;
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .project-info .ae-title::before {
            content: "â—";
            color: #9966cc;
            font-size: 8px;
        }

        .eagle-info {
            flex: 1;
            font-size: 11px;
            color: #bbb;
            line-height: 1.7;
            border-left: 1px solid rgba(74, 144, 226, 0.3);
            padding-left: 15px;
            position: relative;
            min-width: 0; /* å…è®¸æ”¶ç¼© */
            max-width: 50%; /* ç¡®ä¿ä¸è¶…è¿‡ä¸€åŠ */
        }

        .eagle-info::before {
            content: "";
            position: absolute;
            left: -1px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: linear-gradient(to bottom, #4a90e2, rgba(74, 144, 226, 0.3));
            border-radius: 1px;
        }

        .eagle-info .eagle-title {
            color: #4a90e2;
            font-weight: 700;
            margin-bottom: 8px;
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .eagle-info .eagle-title::before {
            content: "â—";
            color: #4a90e2;
            font-size: 8px;
        }

        .project-action-btn {
            background: #2c3e50;
            color: #ecf0f1;
            border: 1px solid #34495e;
            border-radius: 3px;
            padding: 4px 8px;
            font-size: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .project-action-btn:hover {
            background: #34495e;
            border-color: #3c5a78;
        }

        .project-action-btn:active {
            background: #1a252f;
        }

        .project-action-btn .btn-icon {
            font-size: 10px;
        }

        .project-action-btn .btn-text {
            font-size: 9px;
            font-weight: 500;
        }

        /* è¿æ¥çŠ¶æ€æŒ‰é’®æ ·å¼ */
        .connection-status-btn {
            background: #2c3e50;
            color: #ecf0f1;
            border: 1px solid #34495e;
            border-radius: 3px;
            padding: 1px 4px;
            font-size: 9px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 2px;
            min-width: 60px;
            height: 18px;
            line-height: 1;
            box-sizing: border-box;
            margin: 0;
        }

        .connection-status-btn:hover {
            background: #34495e;
            border-color: #3c5a78;
        }

        .connection-status-btn:active {
            background: #1a252f;
        }

        .connection-status-btn .status-indicator {
            width: 5px;
            height: 5px;
            border-radius: 50%;
            background: #e74c3c;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .connection-status-btn .status-indicator.connected {
            background: #27ae60;
            box-shadow: 0 0 6px rgba(39, 174, 96, 0.4);
        }

        .connection-status-btn .status-indicator.connecting {
            background: #f39c12;
            animation: pulse 1.5s infinite;
        }

        .connection-status-btn .status-indicator.error {
            background: #e74c3c;
            animation: shake 0.5s ease-in-out;
        }

        .connection-text {
            display: flex;
            align-items: center;
            gap: 6px;
            line-height: 1;
        }

        .connection-text .status-main {
            font-size: 8px;
            color: #ecf0f1;
            font-weight: 500;
        }

        .connection-text .ping-time {
            font-size: 6px;
            color: #bdc3c7;
            font-family: 'Courier New', monospace;
            background: rgba(255, 255, 255, 0.1);
            padding: 1px 2px;
            border-radius: 2px;
        }

        /* åŸæ¥çš„è¿æ¥çŠ¶æ€æ ·å¼å·²ç§»é™¤ï¼Œä½¿ç”¨æ–°çš„ç´§å‡‘æ ·å¼ */

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-2px); }
            75% { transform: translateX(2px); }
        }

        /* æ—§çš„è¿æ¥çŠ¶æ€æ ·å¼å·²ç§»é™¤ï¼Œä½¿ç”¨ç´§å‡‘æ ·å¼ */

        .content {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .section {
            background: #2a2a2a;
            border-radius: 6px;
            padding: 10px;
            border: 1px solid #555;
        }

        .section-title {
            font-size: 10px;
            font-weight: 600;
            color: #ffffff;
            margin: 0;
            line-height: 20px;
            height: 20px;
            display: flex;
            align-items: center;
        }



        .project-info .label {
            color: #ccc;
            font-weight: 500;
        }

        .eagle-info .label {
            color: #ccc;
            font-weight: 500;
        }

        /* ä¿¡æ¯é¡¹çš„å€¼æ ·å¼ */
        .project-info span:not(.label):not(.ae-title) {
            color: #e0e0e0;
        }

        .eagle-info span:not(.label):not(.eagle-title) {
            color: #e0e0e0;
        }

        /* è·¯å¾„ä¸æ¢è¡Œæ ·å¼ - ä¼˜åŒ–çœç•¥æ˜¾ç¤º */
        .eagle-info #eagle-path,
        .project-info #project-path {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 180px; /* å¢åŠ æœ€å¤§å®½åº¦ï¼Œè®©è·¯å¾„æ˜¾ç¤ºæ›´å¤šå†…å®¹ */
            display: inline-block;
            vertical-align: top;
            cursor: help;
        }

        /* Eagleè·¯å¾„ç‰¹æ®Šå¤„ç† - æ›´å°çš„æœ€å¤§å®½åº¦ */
        .eagle-info #eagle-path {
            max-width: 80px;
        }

        /* è·¯å¾„æ‚¬æµ®æ•ˆæœ */
        .eagle-info #eagle-path:hover,
        .project-info #project-path:hover {
            color: #fff;
            transition: color 0.2s ease;
        }

        /* å¯ç‚¹å‡»è·¯å¾„æ ·å¼ */
        .eagle-info #eagle-path.clickable,
        .eagle-info #eagle-library.clickable,
        .project-info #project-path.clickable {
            cursor: pointer;
            text-decoration: underline;
            color: #4a90e2;
        }

        .eagle-info #eagle-path.clickable:hover,
        .eagle-info #eagle-library.clickable:hover,
        .project-info #project-path.clickable:hover {
            color: #66a3ff;
            text-decoration: underline;
        }

        /* ç¡®ä¿åŒ…å«è·¯å¾„çš„divä¸ä¼šè¶…å‡ºå®¹å™¨ */
        .eagle-info > div,
        .project-info > div {
            max-width: 100%;
            overflow: hidden;
            word-break: break-all;
        }

        /* æ ‡ç­¾å’Œå€¼çš„å¸ƒå±€ä¼˜åŒ– */
        .eagle-info .label,
        .project-info .label {
            min-width: 42px;
            width: 42px;
            flex-shrink: 0;
        }

        /* ä¿¡æ¯è¡Œå¸ƒå±€ */
        .eagle-info > div,
        .project-info > div {
            display: flex;
            align-items: flex-start;
            gap: 4px;
        }

        /* å€¼éƒ¨åˆ†å…è®¸æ”¶ç¼© */
        .eagle-info span:not(.label):not(.eagle-title),
        .project-info span:not(.label):not(.ae-title) {
            flex: 1;
            min-width: 0;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        /* Eagleè·¯å¾„ä¸æ¢è¡Œ - ä¸ä¸Šé¢ç»Ÿä¸€æ ·å¼ */
        .eagle-info #eagle-path {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 180px; /* ä¸ä¸Šé¢ä¿æŒä¸€è‡´ */
            display: inline-block;
            vertical-align: top;
            cursor: help;
        }

        /* é¡¹ç›®ä¿¡æ¯å’ŒEagleä¿¡æ¯çš„æ¯ä¸€è¡Œ */
        .project-info > div, .eagle-info > div {
            margin: 3px 0;
            word-break: keep-all;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .actions-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-bottom: 12px;
        }

        /* ç´§å‡‘çš„æ“ä½œæŒ‰é’®ç½‘æ ¼ - åªæœ‰ä¸¤ä¸ªæŒ‰é’®æ—¶ä½¿ç”¨ */
        .actions-grid-compact {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-bottom: 12px;
        }

        .btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 3px;
            padding: 8px 6px;
            border: none;
            border-radius: 4px;
            font-size: 9px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            min-height: 28px;
            position: relative;
            overflow: hidden;
        }

        .btn-icon {
            font-size: 10px;
            line-height: 1;
        }

        .btn-text {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            line-height: 1;
            font-size: 8px;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: #2980b9;
            transform: translateY(-1px);
        }

        .btn-danger {
            background: #e74c3c;
            color: white;
        }

        .btn-danger:hover:not(:disabled) {
            background: #c0392b;
            transform: translateY(-1px);
        }

        .btn-success {
            background: #27ae60;
            color: white;
        }

        .btn-success:hover:not(:disabled) {
            background: #229954;
        }

        .btn-info {
            background: #17a2b8;
            color: white;
        }

        .btn-info:hover:not(:disabled) {
            background: #138496;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover:not(:disabled) {
            background: #7f8c8d;
            transform: translateY(-1px);
        }

        .btn:disabled {
            background: #555;
            cursor: not-allowed;
            opacity: 0.6;
            transform: none;
        }

        .btn:active:not(:disabled) {
            transform: translateY(0);
        }

        .log {
            display: flex;
            flex-direction: column;
            min-height: 100px;
            max-height: 60vh;
        }

        .log-output {
            background: #1e1e1e;
            border-radius: 4px;
            padding: 8px;
            flex: 1;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 10px;
            border: 1px solid #444;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
        }

        .log-entry {
            margin: 2px 0;
            padding: 1px 0;
        }

        .log-entry.info {
            color: #e0e0e0;
        }

        .log-entry.success {
            color: #27ae60;
        }

        .log-entry.warning {
            color: #f39c12;
        }

        .log-entry.error {
            color: #e74c3c;
        }

        .log-entry.debug {
            color: #9e9e9e;
            font-size: 11px;
        }

        .log-time {
            color: #888;
            margin-right: 6px;
            font-size: 11px;
        }

        /* æ—¥å¿—è®¡æ•°æ ·å¼ */
        .log-count {
            color: #888;
            font-size: 11px;
            margin-left: 5px;
            font-weight: normal;
        }

        /* åˆ†ç»„æ—¥å¿—æ ·å¼ */
        .log-group {
            margin: 2px 0;
            border-left: 3px solid #555;
            background: rgba(255, 255, 255, 0.02);
        }

        .log-group-header {
            padding: 4px 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            background: rgba(255, 255, 255, 0.05);
            user-select: none;
        }

        .log-group-header:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .log-group-content {
            padding-left: 20px;
            max-height: 200px;
            overflow-y: auto;
        }

        .log-group.collapsed .log-group-content {
            display: none;
        }

        .log-group .log-toggle {
            margin-left: auto;
            font-size: 10px;
            color: #888;
        }

        .log-group.collapsed .log-toggle::before {
            content: 'â–¶';
        }

        .log-group.expanded .log-toggle::before {
            content: 'â–¼';
        }

        .log-group-item {
            padding: 2px 8px;
            font-size: 12px;
            color: #ccc;
            border-left: 1px solid #444;
            margin-left: 10px;
        }

        .log-output::-webkit-scrollbar {
            width: 6px;
        }

        .log-output::-webkit-scrollbar-track {
            background: #2a2a2a;
        }

        .log-output::-webkit-scrollbar-thumb {
            background: #555;
            border-radius: 3px;
        }

        .log-output::-webkit-scrollbar-thumb:hover {
            background: #666;
        }

        .import-status {
            background: #1e1e1e;
            border-radius: 4px;
            padding: 8px 12px;
            margin-bottom: 8px;
            border-left: 3px solid #3498db;
            font-size: 10px;
            transition: all 0.3s ease;
        }

        .import-status.success {
            border-left-color: #27ae60;
            background: rgba(39, 174, 96, 0.1);
        }

        .import-status.error {
            border-left-color: #e74c3c;
            background: rgba(231, 76, 60, 0.1);
        }

        .import-status.idle {
            border-left-color: #95a5a6;
            opacity: 0.7;
        }

        .status-message {
            color: #e0e0e0;
            font-weight: 500;
        }

        .log-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .clickable {
            cursor: pointer;
            transition: color 0.2s ease;
        }

        .clickable:hover {
            color: #3498db;
        }

        .log-controls {
            display: flex;
            gap: 4px;
        }

        .section.log {
            display: none;
        }

        .section.log.visible {
            display: block;
        }

        .btn-small {
            padding: 4px 8px;
            border: none;
            border-radius: 3px;
            font-size: 9px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-small.btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-small.btn-secondary:hover {
            background: #7f8c8d;
        }

        .btn-small.btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-small.btn-primary:hover {
            background: #2980b9;
        }

        .log-entry.eagle {
            border-left: 2px solid #f39c12;
            padding-left: 6px;
            background: rgba(243, 156, 18, 0.1);
        }

        .log-entry.ae {
            border-left: 2px solid #3498db;
            padding-left: 6px;
            background: rgba(52, 152, 219, 0.1);
        }

        /* è®¾ç½®é¢æ¿æ ·å¼ */
        .settings-panel {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: #2b2b2b;
            z-index: 1000;
            display: flex;
            flex-direction: column;
        }

        .settings-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 16px;
            background: #1e1e1e;
            border-bottom: 1px solid #444;
        }

        .settings-title {
            font-size: 14px;
            font-weight: 600;
            color: #fff;
        }

        .btn-close {
            background: none;
            border: none;
            color: #999;
            font-size: 18px;
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 3px;
            transition: all 0.2s ease;
        }

        .btn-close:hover {
            background: #444;
            color: #fff;
        }

        .settings-content {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
        }

        .settings-section {
            margin-bottom: 12px;
            padding: 12px;
            background: #1e1e1e;
            border-radius: 6px;
            border: 1px solid #444;
        }

        .settings-section-title {
            font-size: 12px;
            font-weight: 600;
            color: #fff;
            margin-bottom: 8px;
            padding-bottom: 4px;
            border-bottom: 1px solid #444;
        }

        .settings-subsection-title {
            font-size: 11px;
            font-weight: 600;
            color: #ccc;
            margin-bottom: 8px;
        }

        .radio-group, .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .checkbox-group-horizontal {
            display: flex;
            flex-direction: row;
            gap: 8px;
            flex-wrap: wrap;
            align-items: flex-start;
            margin-top: 4px;
        }

        .checkbox-group-horizontal .checkbox-option {
            flex: 1;
            min-width: 0;
            justify-content: flex-start;
            white-space: nowrap;
        }

        .checkbox-group-horizontal .checkbox-option .checkbox-label {
            font-size: 11px;
            line-height: 1.3;
            display: flex;
            align-items: center;
        }

        /* å“åº”å¼è®¾è®¡ï¼šä¸­ç­‰å±å¹•ä¼˜åŒ– */
        @media (max-width: 768px) {
            .checkbox-group-horizontal {
                gap: 4px;
            }

            .checkbox-group-horizontal .checkbox-option {
                flex: 1;
                min-width: 0;
                padding: 4px 6px;
            }

            .checkbox-group-horizontal .checkbox-option .checkbox-label {
                font-size: 10px;
            }
        }

        /* å°å±å¹•ï¼šè¿›ä¸€æ­¥å‹ç¼© */
        @media (max-width: 600px) {
            .checkbox-group-horizontal {
                gap: 2px;
            }

            .checkbox-group-horizontal .checkbox-option {
                padding: 4px;
                gap: 4px;
            }

            .checkbox-group-horizontal .checkbox-option .checkbox-label {
                font-size: 9px;
            }
        }

        /* è¶…å°å±å¹•ï¼šå‚ç›´æ’åˆ— */
        @media (max-width: 400px) {
            .checkbox-group-horizontal {
                flex-direction: column;
                gap: 6px;
            }

            .checkbox-group-horizontal .checkbox-option {
                flex: none;
                min-width: 0;
                white-space: normal;
                padding: 6px 8px;
                gap: 6px;
            }

            .checkbox-group-horizontal .checkbox-option .checkbox-label {
                font-size: 11px;
            }
        }

        .radio-option, .checkbox-option {
            display: flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            padding: 6px 8px;
            border-radius: 4px;
            transition: all 0.2s ease;
        }

        .radio-option:hover, .checkbox-option:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .radio-option.small {
            padding: 4px 8px;
            font-size: 10px;
        }

        .radio-option input[type="radio"] {
            opacity: 0;
            width: 0;
            height: 0;
            pointer-events: none;
        }

        .checkbox-option input[type="checkbox"] {
            margin: 0;
            width: 14px;
            height: 14px;
        }

        .checkbox-option input[type="checkbox"]:checked + .checkbox-label {
            color: #ff8c00;
            font-weight: 500;
        }



        /* é¡¹ç›®æ—å¤åˆ¶æ¨¡å¼çš„å†…è”å¸ƒå±€ */
        .project-adjacent-option {
            align-items: center;
        }

        .project-folder-inline {
            margin-left: auto;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .project-folder-inline select {
            min-width: 120px;
            padding: 4px 8px;
            border: 1px solid #555;
            border-radius: 4px;
            background: #333;
            color: #e0e0e0;
            font-size: 10px;
        }

        .project-folder-inline input[type="text"] {
            min-width: 120px;
            padding: 4px 8px;
            border: 1px solid #555;
            border-radius: 4px;
            background: #333;
            color: #e0e0e0;
            font-size: 10px;
        }

        /* æ¨ªå‘æ’åˆ—çš„å•é€‰æŒ‰é’®ç»„ */
        .radio-group.horizontal {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .radio-group.horizontal .radio-option {
            flex: 1;
            margin-bottom: 0;
            min-width: 0;
            justify-content: center;
            text-align: center;
        }

        .radio-group.horizontal .radio-option .radio-label {
            flex: none;
            white-space: nowrap;
        }

        /* æ—¶é—´è½´é€‰é¡¹æ¨ªå‘å¸ƒå±€ */
        .timeline-options-horizontal {
            display: flex;
            gap: 6px;
            align-items: stretch;
            padding: 8px 0;
            width: 100%;
            flex-wrap: wrap;
        }

        .timeline-option {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
            cursor: pointer;
            padding: 6px 4px;
            border: 1px solid #555;
            border-radius: 4px;
            background: #2a2a2a;
            transition: all 0.2s ease;
            font-size: 9px;
            color: #e0e0e0;
            flex: 1;
            min-width: 0;
            text-align: center;
            white-space: nowrap;
        }

        .timeline-option:hover {
            background: #333;
            border-color: #666;
        }

        .timeline-option input[type="radio"]:checked + span {
            color: #3498db;
            font-weight: 500;
        }

        .timeline-option:has(input[type="radio"]:checked) {
            background: #1e3a5f;
            border-color: #3498db;
        }

        /* å¯¼å…¥åˆæˆæŒ‰é’®ç‹¬ç‰¹æ ·å¼ */
        .composition-toggle {
            padding: 6px 12px;
            background: #2a2a2a;
            border: 1px solid #555;
            border-radius: 3px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 9px;
            color: #e0e0e0;
            margin-right: 8px;
            min-width: 70px;
        }

        .composition-toggle:hover {
            background: #3a3a3a;
            border-color: #666;
        }

        .composition-toggle.active {
            background: #27ae60;
            border-color: #27ae60;
            color: white;
        }

        .composition-toggle.active:hover {
            background: #229954;
            border-color: #229954;
        }

        /* æ—¶é—´è½´é€‰é¡¹ç¦ç”¨çŠ¶æ€ */
        .timeline-options-horizontal.disabled .timeline-option {
            opacity: 0.4;
            pointer-events: none;
            cursor: not-allowed;
        }

        /* å¯¼å…¥åˆæˆæŒ‰é’®åœ¨ç¦ç”¨çŠ¶æ€ä¸‹ä¸å—å½±å“ */
        .timeline-options-horizontal.disabled .composition-toggle {
            opacity: 1;
            pointer-events: auto;
            cursor: pointer;
        }

        .timeline-option input[type="radio"] {
            margin: 0;
        }

        .timeline-option span {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* å¯¼å‡ºæ¨¡å¼é€‰é¡¹æ ·å¼ */
        .export-mode-options {
            margin-top: 12px;
            padding: 8px;
            background: #2a2a2a;
            border-radius: 4px;
            border: 1px solid #444;
        }

        .browse-button {
            padding: 4px 8px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 3px;
            font-size: 11px;
            cursor: pointer;
            margin-left: 8px;
        }

        .browse-button:hover {
            background: #2980b9;
        }

        .sequence-config-inline {
            display: flex;
            align-items: center;
            gap: 6px;
            margin-left: 16px;
            font-size: 10px;
            color: #bbb;
        }

        /* å¯¼å…¥æ¨¡å¼æ¨ªå‘å¸ƒå±€æ ·å¼ */
        .import-mode-options-horizontal {
            display: flex;
            gap: 8px;
            align-items: stretch;
            padding: 4px 0;
            width: 100%;
        }

        .import-mode-option {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            cursor: pointer;
            padding: 6px 8px;
            border: 1px solid #666;
            border-radius: 4px;
            background: transparent;
            transition: all 0.2s ease;
            font-size: 10px;
            color: #ffffff;
            flex: 1;
            min-width: 0;
            text-align: center;
            min-height: 28px;
        }

        .import-mode-option:hover {
            background: transparent;
            border-color: #888;
        }

        .import-mode-option input[type="radio"]:checked + span {
            color: #ffffff;
            font-weight: 600;
        }

        .import-mode-option:has(input[type="radio"]:checked) {
            background: rgba(255, 255, 255, 0.08);
            border-color: #aaa;
        }

        .import-mode-option input[type="radio"] {
            opacity: 0;
            width: 0;
            height: 0;
            pointer-events: none;
        }

        .import-mode-option span {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* é¡ºåºæ’åˆ—é—´éš”è®¾ç½®å¼¹çª—æ ·å¼ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            backdrop-filter: blur(2px);
        }

        .modal-content {
            background: #2a2a2a;
            border: 1px solid #555;
            border-radius: 8px;
            width: 280px;
            max-width: 90vw;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            animation: modalSlideIn 0.2s ease-out;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-20px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
            border-bottom: 1px solid #555;
        }

        .modal-header h3 {
            margin: 0;
            font-size: 13px;
            color: #e0e0e0;
            font-weight: 500;
        }

        .modal-close {
            background: none;
            border: none;
            color: #888;
            font-size: 20px;
            cursor: pointer;
            padding: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            transition: all 0.2s ease;
        }

        .modal-close:hover {
            background: #444;
            color: #e0e0e0;
        }

        .modal-body {
            padding: 16px;
        }

        .interval-setting {
            display: flex;
            gap: 10px;
            align-items: stretch;
            margin-bottom: 12px;
            height: 60px;
        }

        .interval-input-section {
            flex: 1;
            display: flex;
        }

        .interval-input-section input[type="number"] {
            width: 100%;
            height: 100%;
            padding: 15px 10px;
            border: 1px solid #555;
            border-radius: 6px;
            background: #333;
            color: #e0e0e0;
            font-size: 16px;
            text-align: center;
            font-weight: 500;
        }

        .interval-input-section input[type="number"]:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }

        .interval-unit-section {
            display: flex;
            flex-direction: column;
            gap: 3px;
            width: 70px;
            height: 100%;
        }

        .unit-button {
            flex: 1;
            background: #333;
            border: 1px solid #555;
            border-radius: 6px;
            color: #e0e0e0;
            cursor: pointer;
            padding: 8px 6px;
            transition: all 0.2s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            min-height: 0;
        }

        .unit-button span {
            font-weight: 500;
            margin-bottom: 2px;
        }

        .unit-button small {
            font-size: 8px;
            color: #888;
            opacity: 0.8;
        }

        .unit-button:hover {
            background: #444;
            border-color: #666;
        }

        .unit-button.active {
            background: #1e3a5f;
            border-color: #3498db;
            color: #3498db;
        }

        .unit-button.active small {
            color: #3498db;
            opacity: 1;
        }

        .modal-description {
            margin-bottom: 12px;
        }

        .modal-description p {
            margin: 0;
            font-size: 10px;
            color: #bbb;
            text-align: center;
        }

        .modal-footer {
            display: flex;
            padding: 12px 16px;
            border-top: 1px solid #555;
            justify-content: space-between;
        }

        .modal-btn {
            padding: 6px 14px;
            border: 1px solid #555;
            border-radius: 4px;
            cursor: pointer;
            font-size: 10px;
            transition: all 0.2s ease;
            min-width: 50px;
        }

        .modal-btn.cancel {
            background: #333;
            color: #e0e0e0;
        }

        .modal-btn.cancel:hover {
            background: #444;
            border-color: #666;
        }

        .modal-btn.confirm {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }

        .modal-btn.confirm:hover {
            background: #2980b9;
            border-color: #2980b9;
        }

        /* é¡¹ç›®æ—å¤åˆ¶å’ŒæŒ‡å®šæ–‡ä»¶å¤¹å¼¹çª—æ ·å¼ */
        .folder-setting {
            margin-bottom: 12px;
        }

        .folder-preset-section {
            margin-bottom: 12px;
        }

        .folder-preset-section select {
            width: 100%;
            padding: 8px 10px;
            border: 1px solid #555;
            border-radius: 4px;
            background: #333;
            color: #e0e0e0;
            font-size: 11px;
            cursor: pointer;
        }

        .folder-preset-section select:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }

        .folder-preset-section select option {
            background: #333;
            color: #e0e0e0;
        }

        .custom-folder-section input[type="text"] {
            width: 100%;
            padding: 8px 10px;
            border: 1px solid #555;
            border-radius: 4px;
            background: #333;
            color: #e0e0e0;
            font-size: 11px;
        }

        .custom-folder-section input[type="text"]:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }

        /* æŒ‡å®šæ–‡ä»¶å¤¹å¼¹çª—ç‰¹æœ‰æ ·å¼ */
        .folder-path-setting {
            margin-bottom: 12px;
        }

        .folder-path-section {
            display: flex;
            gap: 8px;
            margin-bottom: 12px;
        }

        .folder-path-section input[type="text"] {
            flex: 1;
            padding: 8px 10px;
            border: 1px solid #555;
            border-radius: 4px;
            background: #333;
            color: #e0e0e0;
            font-size: 11px;
        }

        .folder-path-section input[type="text"]:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }

        .browse-button {
            background: #3498db;
            border: 1px solid #3498db;
            border-radius: 4px;
            color: white;
            cursor: pointer;
            padding: 8px 12px;
            font-size: 10px;
            transition: all 0.2s ease;
            white-space: nowrap;
        }

        .browse-button:hover {
            background: #2980b9;
            border-color: #2980b9;
        }

        .recent-folders-section {
            border-top: 1px solid #555;
            padding-top: 12px;
        }

        .recent-folders-title {
            font-size: 10px;
            color: #bbb;
            margin-bottom: 8px;
        }

        .recent-folders-list {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .recent-folder-item {
            background: #333;
            border: 1px solid #555;
            border-radius: 4px;
            color: #e0e0e0;
            cursor: pointer;
            padding: 6px 8px;
            font-size: 9px;
            transition: all 0.2s ease;
            text-align: left;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .recent-folder-text {
            flex: 1;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .recent-folder-delete {
            background: #e74c3c;
            border: none;
            border-radius: 3px;
            color: white;
            cursor: pointer;
            font-size: 8px;
            padding: 2px 4px;
            margin-left: 6px;
            transition: all 0.2s ease;
            flex-shrink: 0;
        }

        .recent-folder-delete:hover {
            background: #c0392b;
        }

        .recent-folder-item:hover {
            background: #444;
            border-color: #666;
        }

        .recent-folder-item.selected {
            background: #1e3a5f;
            border-color: #3498db;
            color: #3498db;
        }

        .radio-label, .checkbox-label {
            display: flex;
            flex-direction: column;
            gap: 2px;
            color: #e0e0e0;
            font-size: 11px;
            line-height: 1.3;
        }

        .radio-label strong {
            color: #fff;
        }

        .radio-label small {
            color: #999;
            font-size: 9px;
        }

        .sub-config {
            margin-left: 24px;
            margin-top: 8px;
            padding: 8px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 4px;
            border-left: 2px solid #3498db;
        }

        .sub-config label {
            display: block;
            font-size: 10px;
            color: #ccc;
            margin-bottom: 4px;
        }

        .sub-config select,
        .sub-config input[type="text"],
        .sub-config input[type="number"] {
            width: 100%;
            padding: 4px 6px;
            background: #333;
            border: 1px solid #555;
            border-radius: 3px;
            color: #fff;
            font-size: 10px;
        }

        .sub-config input[type="number"] {
            width: 60px;
            display: inline-block;
        }

        .folder-input-group {
            display: flex;
            gap: 4px;
        }

        .folder-input-group input {
            flex: 1;
        }

        .recent-folders-section {
            margin-top: 8px;
        }

        .recent-folders-section label {
            display: block;
            margin-bottom: 4px;
            font-size: 10px;
            color: #bbb;
        }

        .recent-folders-select {
            width: 100%;
            padding: 6px 8px;
            border: 1px solid #555;
            border-radius: 4px;
            background: #1e1e1e;
            color: #e0e0e0;
            font-size: 11px;
        }

        .recent-folders-select option {
            background: #1e1e1e;
            color: #e0e0e0;
        }

        /* æ–‡ä»¶å¤¹é€‰æ‹©æ¨¡æ€æ¡†æ ·å¼ */
        .folder-picker-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
        }

        .folder-picker-content {
            background: #2a2a2a;
            border-radius: 8px;
            width: 90%;
            max-width: 600px;
            max-height: 80%;
            overflow: hidden;
            border: 1px solid #555;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
        }

        .folder-picker-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 20px;
            border-bottom: 1px solid #555;
            background: #333;
        }

        .folder-picker-header h3 {
            margin: 0;
            color: #fff;
            font-size: 14px;
        }

        .folder-picker-close {
            background: none;
            border: none;
            color: #bbb;
            font-size: 20px;
            cursor: pointer;
            padding: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .folder-picker-close:hover {
            color: #fff;
            background: #555;
            border-radius: 4px;
        }

        .folder-picker-body {
            padding: 20px;
            max-height: 400px;
            overflow-y: auto;
        }

        .picker-btn {
            background: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 8px 16px;
            font-size: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .picker-btn:hover:not(:disabled) {
            background: #2980b9;
        }

        .picker-btn:disabled {
            background: #555;
            cursor: not-allowed;
        }

        .picker-btn.secondary {
            background: #95a5a6;
        }

        .picker-btn.secondary:hover:not(:disabled) {
            background: #7f8c8d;
        }

        .folder-drop-zone {
            border: 2px dashed #555;
            border-radius: 8px;
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-bottom: 20px;
            background: #1e1e1e;
        }

        .folder-drop-zone:hover {
            border-color: #3498db;
            background: rgba(52, 152, 219, 0.1);
        }

        .folder-drop-zone.drag-over {
            border-color: #27ae60;
            background: rgba(39, 174, 96, 0.1);
        }

        .drop-zone-icon {
            font-size: 32px;
            margin-bottom: 12px;
        }

        .drop-zone-text {
            color: #fff;
            font-size: 13px;
            margin-bottom: 6px;
            font-weight: 500;
        }

        .drop-zone-hint {
            color: #bbb;
            font-size: 11px;
        }

        .manual-input-section {
            background: #1e1e1e;
            border: 1px solid #555;
            border-radius: 6px;
            padding: 16px;
        }

        .manual-input-section label {
            display: block;
            color: #fff;
            font-size: 12px;
            margin-bottom: 8px;
        }

        .manual-input-group {
            display: flex;
            gap: 8px;
        }

        .manual-input-group input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #555;
            border-radius: 4px;
            background: #333;
            color: #e0e0e0;
            font-size: 11px;
        }

        .manual-input-group input:focus {
            outline: none;
            border-color: #3498db;
            background: #2a2a2a;
        }



        .folder-picker-footer {
            display: flex;
            justify-content: flex-end;
            gap: 8px;
            padding: 16px 20px;
            border-top: 1px solid #555;
            background: #333;
        }

        .settings-footer {
            padding: 12px 16px;
            background: #1e1e1e;
            border-top: 1px solid #444;
            display: flex;
            justify-content: space-between;
            gap: 8px;
        }

        .settings-footer .btn {
            min-width: 80px;
        }

        /* è¾“å…¥ç»„æ ·å¼ */
        .input-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 4px;
        }

        .input-option {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .input-label {
            font-size: 12px;
            color: #e0e0e0;
            font-weight: 500;
        }

        .input-wrapper {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .input-wrapper input[type="number"] {
            background: #1e1e1e;
            border: 1px solid #555;
            border-radius: 4px;
            color: #e0e0e0;
            font-size: 12px;
            padding: 8px 12px;
            width: 120px;
        }

        .input-wrapper input[type="number"]:focus {
            outline: none;
            border-color: #007acc;
            box-shadow: 0 0 0 2px rgba(0, 122, 204, 0.2);
        }

        .input-hint {
            font-size: 10px;
            color: #888;
            font-style: italic;
        }

        /* éŸ³é‡æ»‘å—æ ·å¼ */
        .input-wrapper input[type="range"] {
            width: 120px;
            height: 4px;
            background: #333;
            border-radius: 2px;
            outline: none;
            -webkit-appearance: none;
        }

        .input-wrapper input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 12px;
            height: 12px;
            background: #007acc;
            border-radius: 50%;
            cursor: pointer;
        }

        .input-wrapper input[type="range"]::-moz-range-thumb {
            width: 12px;
            height: 12px;
            background: #007acc;
            border-radius: 50%;
            cursor: pointer;
            border: none;
        }

        /* æµ‹è¯•æŒ‰é’®æ ·å¼ */
        .test-button {
            background: #4a4a4a;
            border: 1px solid #666;
            border-radius: 4px;
            color: #e0e0e0;
            font-size: 11px;
            padding: 6px 12px;
            cursor: pointer;
            margin-top: 8px;
            transition: background-color 0.2s;
        }

        .test-button:hover {
            background: #5a5a5a;
        }

        .test-button:active {
            background: #3a3a3a;
        }

        /* å¯¼å…¥æ¨¡å¼é€‰æ‹©æ ·å¼ */
        .import-mode-selection {
            margin-top: 8px;
            margin-bottom: 8px;
        }

        .mode-buttons {
            display: flex;
            gap: 4px;
            margin-bottom: 0;
        }

        .mode-button {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 6px 8px;
            background: transparent;
            border: 1px solid #2196f3;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            font-size: 10px;
            color: #2196f3;
            user-select: none;
        }

        .mode-button:hover {
            background: rgba(33, 150, 243, 0.15);
            border-color: #42a5f5;
            color: #42a5f5;
        }

        .mode-button input[type="radio"],
        .mode-button input[type="checkbox"] {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
            pointer-events: none;
        }

        .mode-button input[type="radio"]:checked + .mode-text,
        .mode-button input[type="checkbox"]:checked + .mode-text {
            color: #1976d2;
            font-weight: 600;
        }

        .mode-button:has(input[type="radio"]:checked),
        .mode-button:has(input[type="checkbox"]:checked) {
            background: rgba(33, 150, 243, 0.15);
            border-color: #2196f3;
            box-shadow: 0 0 4px rgba(33, 150, 243, 0.2);
        }

        /* å¯¼å…¥åˆæˆæŒ‰é’®æ¿€æ´»çŠ¶æ€ */
        .mode-button.active {
            background: #007acc;
            border-color: #007acc;
            color: white;
        }

        .mode-button.active:hover {
            background: #005a9e;
            border-color: #005a9e;
        }

        .mode-button.checked {
            background: transparent;
            border-color: #007acc;
        }

        .mode-text {
            transition: color 0.2s ease;
        }

        /* å¯¼å…¥è¡Œä¸ºè®¾ç½®æ ·å¼ */
        .import-behavior {
            margin-bottom: 8px;
            margin-top: 0;
        }

        .import-behavior-buttons {
            display: flex;
            gap: 4px;
            margin-bottom: 0;
        }

        .import-behavior-button {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 6px 8px;
            background: transparent;
            border: 1px solid #ff9800;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            font-size: 10px;
            color: #ff9800;
            user-select: none;
        }

        .import-behavior-button:hover {
            background: rgba(255, 152, 0, 0.15);
            border-color: #ffb74d;
            color: #ffb74d;
        }

        .import-behavior-button input[type="radio"] {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
            pointer-events: none;
        }

        .import-behavior-button input[type="radio"]:checked + .behavior-text {
            color: #f57c00;
            font-weight: 600;
        }

        .import-behavior-button:has(input[type="radio"]:checked) {
            background: rgba(255, 152, 0, 0.15);
            border-color: #ff9800;
            box-shadow: 0 0 4px rgba(255, 152, 0, 0.2);
        }

        .behavior-text {
            transition: color 0.2s ease;
        }

        /* å›¾å±‚æ“ä½œæŒ‰é’®æ ·å¼ */
        .layer-operations {
            margin-top: 8px;
        }

        .layer-operation-buttons {
            display: flex;
            gap: 4px;
            margin-bottom: 8px;
        }

        .layer-operation-button {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 6px 8px;
            background: transparent;
            border: 1px solid #9b59b6;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 10px;
            color: #9b59b6;
            user-select: none;
        }

        .layer-operation-button:hover {
            background: rgba(155, 89, 182, 0.1);
            border-color: #a569bd;
            color: #a569bd;
        }

        .layer-operation-button:active {
            background: #1a1a1a;
            transform: translateY(1px);
        }

        /* å›¾å±‚æ“ä½œæŒ‰é’®å˜ç°æ ·å¼ */
        .layer-operation-button.dimmed {
            opacity: 0.4;
            color: #666;
            background-color: #2a2a2a !important;
            border-color: #444 !important;
            cursor: not-allowed;
            filter: grayscale(50%);
            transition: all 0.3s ease;
        }
        
        .layer-operation-button.dimmed:hover {
            opacity: 0.4;
            background-color: #2a2a2a !important;
            border-color: #444 !important;
            transform: none;
        }

        .layer-operation-button.dimmed:hover {
            opacity: 0.6;
            color: #777;
        }

        .operation-text {
            transition: color 0.2s ease;
        }

        /* é«˜çº§è®¾ç½®å¯¼å…¥è¡Œä¸ºæŒ‰é’®æ ·å¼ */
        .import-behavior-options-horizontal {
            display: flex;
            gap: 8px;
            margin-top: 4px;
        }

        .import-behavior-option {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 6px 8px;
            background: transparent;
            border: 1px solid #666;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 10px;
            color: #ffffff;
            min-height: 28px;
        }

        .import-behavior-option:hover {
            background: transparent;
            border-color: #888;
        }

        .import-behavior-option input[type="radio"] {
            opacity: 0;
            width: 0;
            height: 0;
            pointer-events: none;
        }

        .import-behavior-option input[type="radio"]:checked + span {
            color: #ffffff;
            font-weight: 600;
        }

        .import-behavior-option:has(input[type="radio"]:checked) {
            background: rgba(255, 255, 255, 0.08);
            border-color: #aaa;
        }

        .btn-small {
            padding: 3px 8px;
            font-size: 10px;
            min-width: auto;
            height: 22px;
        }

        /* ==================== æ‹–æ‹½å¯¼å…¥æ ·å¼ ==================== */

        /* æ‹–æ‹½æ‚¬åœæ—¶çš„æ•´ä½“æ•ˆæœ */
        body.drag-over {
            transition: all 0.3s ease;
        }

        /* æ‹–æ‹½æ—¶çš„èƒŒæ™¯è’™ç‰ˆ */
        body.drag-over::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(4px);
            -webkit-backdrop-filter: blur(4px);
            z-index: 999;
            pointer-events: none;
            animation: fadeIn 0.3s ease;
        }

        /* æ‹–æ‹½æ—¶çš„è¾¹æ¡†æ•ˆæœ */
        body.drag-over::after {
            content: '';
            position: fixed;
            top: 8px;
            left: 8px;
            right: 8px;
            bottom: 8px;
            border: 2px dashed #3498db;
            border-radius: 12px;
            z-index: 1000;
            pointer-events: none;
            animation: dragPulse 1.5s ease-in-out infinite alternate;
        }

        /* æ‹–æ‹½æ—¶çš„ç®€çº¦ä¸­å¤®æç¤º */
        .drag-overlay {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            z-index: 1002;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s ease;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        body.drag-over .drag-overlay {
            opacity: 1;
        }

        .drag-overlay .drag-icon {
            color: #3498db;
            font-size: 48px;
            font-weight: 200;
            line-height: 1;
            margin-bottom: 8px;
        }

        .drag-overlay .drag-text {
            color: #3498db;
            font-size: 13px;
            font-weight: 400;
            opacity: 0.8;
        }

        @keyframes dragPulse {
            from { opacity: 0.3; }
            to { opacity: 0.7; }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* æ‹–æ‹½æç¤ºæ ·å¼ */
        .drag-hint {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            color: #e0e0e0;
            padding: 16px 24px;
            border-radius: 8px;
            border: 1px solid #555;
            z-index: 1001;
            animation: fadeInOut 3s ease-in-out;
            pointer-events: none;
        }

        .drag-hint-content {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .drag-hint-icon {
            font-size: 18px;
        }

        .drag-hint-text {
            font-size: 12px;
            font-weight: 500;
        }

        @keyframes fadeInOut {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.9); }
            20% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            80% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(0.9); }
        }

        /* å¯¼å…¥çŠ¶æ€å¢å¼º */
        .import-status.processing {
            border-left-color: #3498db;
            background: rgba(52, 152, 219, 0.1);
            animation: processingPulse 1.5s ease-in-out infinite;
        }

        @keyframes processingPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* æ‹–æ‹½åŒºåŸŸæŒ‡ç¤ºå™¨ */
        .panel.drag-active {
            border: 2px dashed #3498db;
            background: rgba(52, 152, 219, 0.05);
            transition: all 0.2s ease;
        }

        /* Eagleç¡®è®¤å¯¹è¯æ¡† */
        .eagle-confirm-dialog {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1002;
            animation: fadeIn 0.3s ease;
        }

        .eagle-confirm-content {
            background: #2a2a2a;
            border-radius: 8px;
            border: 1px solid #555;
            max-width: 400px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .eagle-confirm-header {
            padding: 16px 20px;
            border-bottom: 1px solid #555;
        }

        .eagle-confirm-header h3 {
            margin: 0;
            color: #ffffff;
            font-size: 14px;
            font-weight: 600;
        }

        .eagle-confirm-body {
            padding: 20px;
            color: #e0e0e0;
            font-size: 12px;
            line-height: 1.5;
        }

        .eagle-confirm-body p {
            margin: 0 0 12px 0;
        }

        .file-list {
            background: #1a1a1a;
            border: 1px solid #444;
            border-radius: 4px;
            padding: 8px;
            margin-top: 12px;
            max-height: 120px;
            overflow-y: auto;
        }

        .file-item {
            padding: 4px 0;
            color: #ccc;
            font-size: 11px;
            border-bottom: 1px solid #333;
        }

        .file-item:last-child {
            border-bottom: none;
        }

        .eagle-confirm-actions {
            padding: 16px 20px;
            border-top: 1px solid #555;
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        .eagle-confirm-actions button {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-cancel {
            background: #666;
            color: #fff;
        }

        .btn-cancel:hover {
            background: #777;
        }

        .btn-primary {
            background: #3498db;
            color: #fff;
        }

        .btn-primary:hover {
            background: #2980b9;
        }

        /* æ–°å¢çš„å¯¼å…¥è®¾ç½®æš—è‰²æ ·å¼ */
        .import-settings-dark {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 4px;
            padding: 12px;
            margin-top: 12px;
            display: flex;
            gap: 20px;
        }

        .setting-item {
            display: flex;
            align-items: center;
            gap: 6px;
            color: #e0e0e0;
            font-size: 11px;
            flex: 1;
        }

        .setting-label {
            color: #999;
            font-weight: normal;
        }

        .setting-value {
            color: #e0e0e0;
            font-weight: 500;
        }

        /* æ–°å¢çš„æŒ‰é’®å¸ƒå±€æ ·å¼ */
        .eagle-confirm-actions-flex {
            padding: 16px 20px;
            border-top: 1px solid #555;
            display: flex;
            justify-content: space-between;
            gap: 8px;
        }

        /* æ–°å¢çš„æè¾¹æŒ‰é’®æ ·å¼ */
        .btn-outline-secondary {
            padding: 8px 16px;
            border: 1px solid #666;
            border-radius: 4px;
            background: transparent;
            color: #ccc;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-outline-secondary:hover {
            border-color: #777;
            background: rgba(102, 102, 102, 0.1);
            color: #fff;
        }

        .btn-outline-primary {
            padding: 8px 16px;
            border: 1px solid #3498db;
            border-radius: 4px;
            background: transparent;
            color: #3498db;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-outline-primary:hover {
            border-color: #2980b9;
            background: rgba(52, 152, 219, 0.1);
            color: #2980b9;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* æ‹–æ‹½åé¦ˆæ¶ˆæ¯ */
        .drop-message {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(42, 42, 42, 0.95);
            border: 1px solid #555;
            border-radius: 6px;
            padding: 12px 16px;
            z-index: 1003;
            transform: translateX(100%);
            transition: transform 0.3s ease, opacity 0.3s ease;
            opacity: 0;
            max-width: 300px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .drop-message-show {
            transform: translateX(0);
            opacity: 1;
        }

        .drop-message-content {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .drop-message-icon {
            font-size: 16px;
            flex-shrink: 0;
        }

        .drop-message-text {
            color: #e0e0e0;
            font-size: 12px;
            font-weight: 500;
            line-height: 1.4;
        }

        .drop-message-info {
            border-left: 3px solid #3498db;
        }

        .drop-message-processing {
            border-left: 3px solid #f39c12;
            animation: processingPulse 1.5s ease-in-out infinite;
        }

        .drop-message-success {
            border-left: 3px solid #27ae60;
        }

        .drop-message-error {
            border-left: 3px solid #e74c3c;
        }

        .drop-message-warning {
            border-left: 3px solid #f39c12;
        }

        /* å‰ªè´´æ¿å¯¼å…¥ç›¸å…³æ ·å¼ */
        .clipboard-preview {
            margin: 12px 0;
            max-height: 200px;
            overflow-y: auto;
        }

        .clipboard-preview .file-item {
            display: flex;
            align-items: center;
            padding: 8px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
            margin-bottom: 6px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .clipboard-preview .file-item:last-child {
            margin-bottom: 0;
        }

        .clipboard-preview .file-icon {
            font-size: 16px;
            margin-right: 8px;
            flex-shrink: 0;
        }

        .clipboard-preview .file-info {
            flex: 1;
            min-width: 0;
        }

        .clipboard-preview .file-name-container {
            margin-bottom: 2px;
            word-break: break-all;
        }

        .clipboard-preview .file-name {
            font-size: 12px;
            font-weight: 500;
            color: #e0e0e0;
            display: inline;
        }

        .clipboard-preview .file-name.editable {
            cursor: pointer;
            padding: 1px 2px;
            border-radius: 2px;
            transition: background-color 0.2s;
        }

        .clipboard-preview .file-name.editable:hover {
            background-color: rgba(52, 152, 219, 0.2);
            color: #3498db;
        }

        .clipboard-preview .file-ext {
            font-size: 12px;
            font-weight: 500;
            color: #999;
            display: inline;
        }

        .clipboard-preview .file-details {
            font-size: 10px;
            color: #999;
        }

        .temp-file-warning {
            color: #f39c12;
            font-size: 10px;
            font-weight: normal;
        }

        .original-file-info {
            color: #27ae60;
            font-size: 10px;
            font-weight: normal;
        }

        .import-info {
            margin-top: 12px;
            padding: 8px;
            background: rgba(52, 152, 219, 0.1);
            border-radius: 4px;
            border-left: 3px solid #3498db;
        }

        .import-mode-info {
            font-size: 11px;
            color: #e0e0e0;
            line-height: 1.4;
        }

        /* æ–°çš„ç®€åŒ–æ–‡ä»¶åˆ—è¡¨æ ·å¼ */
        .file-item-simple {
            display: flex;
            align-items: center;
            padding: 6px 8px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
            margin-bottom: 4px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            gap: 8px;
            font-size: 11px;
        }

        .file-item-simple:last-child {
            margin-bottom: 0;
        }

        .file-item-simple .file-icon {
            font-size: 14px;
            flex-shrink: 0;
            width: 16px;
            text-align: center;
        }

        .file-item-simple .file-name {
            flex: 1;
            color: #e0e0e0;
            font-weight: 500;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            min-width: 0;
        }

        .file-item-simple .file-size {
            color: #999;
            font-size: 10px;
            flex-shrink: 0;
            min-width: 40px;
            text-align: right;
        }

        .file-item-simple .file-type {
            color: #999;
            font-size: 10px;
            flex-shrink: 0;
            min-width: 60px;
            text-align: right;
        }

        /* å¯¼å…¥è®¾ç½®æ ·å¼ */
        .import-settings {
            margin-top: 12px;
            padding: 8px 12px;
            background: rgba(52, 152, 219, 0.1);
            border-radius: 4px;
            border-left: 3px solid #3498db;
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
        }

        .import-settings span {
            font-size: 11px;
            color: #e0e0e0;
            line-height: 1.4;
        }

        .import-settings strong {
            color: #3498db;
            font-weight: 600;
        }

        .import-mode-info strong {
            color: #3498db;
        }
    </style>
</head>
<body>
    <div class="panel">
        <div class="header">
            <div class="title">
                <img src="public/logo.png" alt="Eagle2AE Logo" class="title-logo">
                <div class="title-text">
                    <span class="char char-e1">E</span>
                    <span class="char char-a1">a</span>
                    <span class="char char-g1">g</span>
                    <span class="char char-l1">l</span>
                    <span class="char char-e2">e</span>
                    <span class="char char-2">2</span>
                    <span class="char char-a2">A</span>
                    <span class="char char-e3">e</span>
                </div>
            </div>
            <div class="header-actions">
                <button id="log-panel-toggle" class="icon-btn" title="æ˜¾ç¤º/éšè—æ—¥å¿—">
                    <span class="icon">ğŸ“„</span>
                </button>
                <button id="settings-btn" class="icon-btn" title="é«˜çº§è®¾ç½®">
                    <span class="icon">âš™ï¸</span>
                </button>
            </div>
        </div>

        <div class="content">
            <div class="section">
                <div class="section-header">
                    <div class="section-title">é¡¹ç›®ä¿¡æ¯</div>
                    <button id="test-connection-btn" class="connection-status-btn" title="ç‚¹å‡»æµ‹è¯•è¿æ¥">
                        <div id="status-indicator" class="status-indicator"></div>
                        <div class="connection-text">
                            <span id="status-main" class="status-main">æœªè¿æ¥</span>
                            <span id="ping-time" class="ping-time">--ms</span>
                        </div>
                    </button>
                </div>
                <div class="project-info-container">
                    <div class="project-info">
                        <div class="ae-title">After Effects</div>
                        <div><span class="label">ç‰ˆæœ¬:</span> <span id="ae-version">è·å–ä¸­...</span></div>
                        <div><span class="label">è·¯å¾„:</span> <span id="project-path">æœªçŸ¥</span></div>
                        <div><span class="label">é¡¹ç›®:</span> <span id="project-name">æœªæ‰“å¼€é¡¹ç›®</span></div>
                        <div><span class="label">åˆæˆ:</span> <span id="comp-name">æ— </span></div>
                    </div>
                    <div class="eagle-info">
                        <div class="eagle-title">Eagle</div>
                        <div><span class="label">ç‰ˆæœ¬:</span> <span id="eagle-version">è·å–ä¸­...</span></div>
                        <div><span class="label">è·¯å¾„:</span> <span id="eagle-path">è·å–ä¸­...</span></div>
                        <div><span class="label">èµ„æºåº“:</span> <span id="eagle-library">è·å–ä¸­...</span></div>
                        <div><span class="label">å½“å‰ç»„:</span> <span id="eagle-folder">è·å–ä¸­...</span></div>
                    </div>
                </div>
            </div>

            <!-- å¯¼å…¥æ¨¡å¼å’Œè¡Œä¸ºé¢æ¿ -->
            <div class="section">
                <div class="section-title">å¯¼å…¥æ¨¡å¼&è¡Œä¸º</div>

                <!-- å¯¼å…¥æ¨¡å¼é€‰æ‹© -->
                <div class="import-mode-selection">
                    <div class="mode-buttons">
                        <label class="mode-button" title="ä»æºç›®å½•ç›´æ¥å¯¼å…¥åˆ°AEé¡¹ç›®ï¼Œä¸å¤åˆ¶æ–‡ä»¶">
                            <input type="radio" name="quick-import-mode" value="direct">
                            <span class="mode-text">ç›´æ¥å¯¼å…¥</span>
                        </label>
                        <label class="mode-button" title="å¤åˆ¶æ–‡ä»¶åˆ°AEé¡¹ç›®æ–‡ä»¶æ—è¾¹åå¯¼å…¥">
                            <input type="radio" name="quick-import-mode" value="project_adjacent" checked>
                            <span class="mode-text">é¡¹ç›®æ—å¤åˆ¶</span>
                        </label>
                        <label class="mode-button" title="å¤åˆ¶æ–‡ä»¶åˆ°æŒ‡å®šæ–‡ä»¶å¤¹åå¯¼å…¥">
                            <input type="radio" name="quick-import-mode" value="custom_folder">
                            <span class="mode-text">æŒ‡å®šæ–‡ä»¶å¤¹</span>
                        </label>
                    </div>
                </div>

                <!-- å¯¼å…¥è¡Œä¸ºè®¾ç½® -->
                <div class="import-behavior">
                    <div class="import-behavior-buttons">
                        <label class="import-behavior-button" title="ä¸å°†å¯¼å…¥çš„ç´ ææ·»åŠ åˆ°åˆæˆä¸­">
                            <input type="radio" name="import-behavior" value="no_import">
                            <span class="behavior-text">ä¸å¯¼å…¥åˆæˆ</span>
                        </label>
                        <label class="import-behavior-button" title="å°†ç´ ææ”¾ç½®åœ¨å½“å‰æ—¶é—´æŒ‡é’ˆä½ç½®">
                            <input type="radio" name="import-behavior" value="current_time" checked>
                            <span class="behavior-text">å½“å‰æ—¶é—´</span>
                        </label>
                        <label class="import-behavior-button" title="å°†ç´ æç§»è‡³æ—¶é—´è½´å¼€å§‹å¤„ï¼ˆ0ç§’ä½ç½®ï¼‰">
                            <input type="radio" name="import-behavior" value="timeline_start">
                            <span class="behavior-text">æ—¶é—´è½´å¼€å§‹</span>
                        </label>
                    </div>
                </div>

                <!-- å›¾å±‚æ“ä½œæŒ‰é’® -->
                <div class="layer-operations" style="margin-top: 16px;">
                    <div class="layer-operation-buttons">
                        <button class="layer-operation-button" id="detect-layers-btn" title="æ£€æµ‹å½“å‰åˆæˆä¸­çš„å›¾å±‚">
                            <span class="operation-text">æ£€æµ‹å›¾å±‚</span>
                        </button>
                        <button class="layer-operation-button" id="export-layers-btn" title="å¯¼å‡ºé€‰ä¸­çš„å›¾å±‚">
                            <span class="operation-text">å¯¼å‡ºå›¾å±‚</span>
                        </button>
                        <button class="layer-operation-button" id="export-to-eagle-btn" title="å°†AEå›¾å±‚æ•°æ®å¯¼å‡ºåˆ°Eagleèµ„æºåº“">
                            <span class="operation-text">å¯¼å‡ºåˆ°Eagle</span>
                        </button>
                    </div>
                </div>
            </div>



            <!-- çŠ¶æ€ä¿¡æ¯é¢æ¿ -->
            <div class="section">
                <div class="section-title">çŠ¶æ€ä¿¡æ¯</div>
                <div id="import-status" class="import-status idle">
                    <span id="latest-log-message" class="status-message">ç­‰å¾…å¯¼å…¥è¯·æ±‚...</span>
                </div>
            </div>

            <div class="section log">
                <div class="log-header">
                    <div id="log-title" class="section-title clickable">æ—¥å¿— (AEæ‰©å±•)</div>
                    <div class="log-controls">
                        <button id="log-switch-btn" class="btn-small btn-secondary">åˆ‡æ¢åˆ°Eagleæ—¥å¿—</button>
                        <button id="clear-log-btn" class="btn-small btn-secondary">æ¸…ç†æ—¥å¿—</button>
                    </div>
                </div>
                <div id="log-output" class="log-output"></div>
            </div>
        </div>

        <!-- æ–‡ä»¶å¤¹é€‰æ‹©æ¨¡æ€æ¡† -->
        <div id="folder-picker-modal" class="folder-picker-modal" style="display: none;">
            <div class="folder-picker-content">
                <div class="folder-picker-header">
                    <h3>é€‰æ‹©ç›®æ ‡æ–‡ä»¶å¤¹</h3>
                    <button id="folder-picker-close" class="folder-picker-close">Ã—</button>
                </div>
                <div class="folder-picker-body">
                    <!-- æ‹–æ‹½é€‰æ‹©åŒºåŸŸ -->
                    <div id="folder-drop-zone" class="folder-drop-zone">
                        <div class="drop-zone-content">
                            <div class="drop-zone-icon">ğŸ“‚</div>
                            <div class="drop-zone-text">å°†æ–‡ä»¶å¤¹æ‹–æ‹½åˆ°è¿™é‡Œ</div>
                            <div class="drop-zone-hint">æˆ–ç‚¹å‡»é€‰æ‹©æ–‡ä»¶å¤¹</div>
                        </div>
                    </div>

                    <!-- æ‰‹åŠ¨è¾“å…¥åŒºåŸŸ -->
                    <div class="manual-input-section">
                        <label>æˆ–æ‰‹åŠ¨è¾“å…¥è·¯å¾„ï¼š</label>
                        <div class="manual-input-group">
                            <input type="text" id="manual-folder-input" placeholder="è¾“å…¥æ–‡ä»¶å¤¹è·¯å¾„...">
                            <button id="validate-path-btn" class="picker-btn secondary">éªŒè¯</button>
                        </div>
                    </div>
                </div>
                <div class="folder-picker-footer">
                    <button id="folder-picker-cancel" class="picker-btn secondary">å–æ¶ˆ</button>
                    <button id="folder-picker-confirm" class="picker-btn primary" disabled>ç¡®è®¤</button>
                </div>
            </div>
        </div>

        <!-- è®¾ç½®é¢æ¿ -->
        <div id="settings-panel" class="settings-panel" style="display: none;">
            <div class="settings-header">
                <div class="settings-title">é«˜çº§è®¾ç½®</div>
                <button id="settings-close-btn" class="btn-close">Ã—</button>
            </div>

            <div class="settings-content">
                <!-- å¯¼å…¥æ¨¡å¼è®¾ç½® -->
                <div class="settings-section">
                    <div class="settings-section-title">å¯¼å…¥æ¨¡å¼</div>
                    <div class="import-mode-options-horizontal">
                        <label class="import-mode-option" title="ä»Eagleç›´æ¥å¯¼å…¥åˆ°AEé¡¹ç›®">
                            <input type="radio" name="import-mode" value="direct">
                            <span>ç›´æ¥å¯¼å…¥</span>
                        </label>
                        <label class="import-mode-option" title="å¤åˆ¶åˆ°AEé¡¹ç›®æ–‡ä»¶æ—è¾¹åå¯¼å…¥">
                            <input type="radio" name="import-mode" value="project_adjacent" checked>
                            <span>é¡¹ç›®æ—å¤åˆ¶</span>
                        </label>
                        <label class="import-mode-option" title="å¤åˆ¶åˆ°æŒ‡å®šæ–‡ä»¶å¤¹åå¯¼å…¥">
                            <input type="radio" name="import-mode" value="custom_folder">
                            <span>æŒ‡å®šæ–‡ä»¶å¤¹</span>
                        </label>
                    </div>
                </div>

                <!-- å¯¼å…¥è¡Œä¸ºè®¾ç½® -->
                <div class="settings-section">
                    <div class="settings-section-title">å¯¼å…¥è¡Œä¸º</div>
                    <div class="import-behavior-options-horizontal">
                        <label class="import-behavior-option" title="ä¸å°†å¯¼å…¥çš„ç´ ææ·»åŠ åˆ°åˆæˆä¸­">
                            <input type="radio" name="advanced-import-behavior" value="no_import">
                            <span>ä¸å¯¼å…¥åˆæˆ</span>
                        </label>
                        <label class="import-behavior-option" title="å°†ç´ ææ”¾ç½®åœ¨å½“å‰æ—¶é—´æŒ‡é’ˆä½ç½®">
                            <input type="radio" name="advanced-import-behavior" value="current_time" checked>
                            <span>å½“å‰æ—¶é—´</span>
                        </label>
                        <label class="import-behavior-option" title="å°†ç´ æç§»è‡³æ—¶é—´è½´å¼€å§‹å¤„ï¼ˆ0ç§’ä½ç½®ï¼‰">
                            <input type="radio" name="advanced-import-behavior" value="timeline_start">
                            <span>æ—¶é—´è½´å¼€å§‹</span>
                        </label>
                    </div>
                </div>

                <!-- å¯¼å‡ºè·¯å¾„è®¾ç½® -->
                <div class="settings-section">
                    <div class="settings-section-title">å¯¼å‡ºè·¯å¾„è®¾ç½®</div>
                    <div class="import-mode-options-horizontal">
                        <label class="import-mode-option" title="ç›´æ¥å¯¼å‡ºåˆ°æ¡Œé¢">
                            <input type="radio" name="export-mode" value="desktop" checked>
                            <span>æ¡Œé¢å¯¼å‡º</span>
                        </label>
                        <label class="import-mode-option" title="å¯¼å‡ºåˆ°AEé¡¹ç›®æ–‡ä»¶æ—è¾¹çš„æ–‡ä»¶å¤¹ï¼ˆä¸å¯¼å…¥æ¨¡å¼è®¾ç½®ä¸€è‡´ï¼‰">
                            <input type="radio" name="export-mode" value="project_adjacent">
                            <span>é¡¹ç›®æ—å¯¼å‡º</span>
                        </label>
                        <label class="import-mode-option" id="export-custom-folder-option" title="å¯¼å‡ºåˆ°æŒ‡å®šæ–‡ä»¶å¤¹ï¼ˆä¸å¯¼å…¥æ¨¡å¼è®¾ç½®ä¸€è‡´ï¼‰">
                            <input type="radio" name="export-mode" value="custom_folder">
                            <span>æŒ‡å®šæ–‡ä»¶å¤¹</span>
                        </label>
                    </div>

                    <!-- å¯¼å‡ºé€‰é¡¹ -->
                    <div class="checkbox-group-horizontal">
                        <label class="checkbox-option" title="å¯¼å‡ºå®Œæˆåè‡ªåŠ¨å¤åˆ¶å¯¼å‡ºè·¯å¾„å’Œæ–‡ä»¶åˆ°å‰ªåˆ‡æ¿ï¼Œå¯ç›´æ¥ç²˜è´´ä½¿ç”¨">
                            <input type="checkbox" id="export-auto-copy" checked>
                            <span class="checkbox-label">è‡ªåŠ¨å¤åˆ¶</span>
                        </label>
                        <label class="checkbox-option" id="burn-after-reading-label" title="å¯ç”¨åå›¾ç‰‡å¯¼å‡ºåˆ°ä¸´æ—¶æ–‡ä»¶å¤¹ï¼Œå¯¼å‡ºåå¤åˆ¶åˆ°å‰ªåˆ‡æ¿ã€‚&#10;æ–‡ä»¶ç´¯è®¡è¶…è¿‡100MBæˆ–100ä¸ªæ–‡ä»¶åè‡ªåŠ¨æ¸…ç©ºã€‚&#10;Alt+ç‚¹å‡»æ¸…ç©ºï¼ŒCtrl+ç‚¹å‡»æ‰“å¼€ä¸´æ—¶æ–‡ä»¶å¤¹ã€‚">
                            <input type="checkbox" id="export-burn-after-reading">
                            <span class="checkbox-label">é˜…åå³ç„š</span>
                        </label>
                        <label class="checkbox-option" title="åœ¨å¯¼å‡ºæ–‡ä»¶å¤¹åç§°å‰æ·»åŠ æ—¶é—´æˆ³ï¼Œå¦‚ï¼š20240101_120000_Export">
                            <input type="checkbox" id="export-add-timestamp" checked>
                            <span class="checkbox-label">æ—¶é—´æˆ³å‰ç¼€</span>
                        </label>
                        <label class="checkbox-option" title="åœ¨å¯¼å‡ºæ–‡ä»¶å¤¹åç§°å‰æ·»åŠ å½“å‰åˆæˆåç§°ï¼Œå¦‚ï¼šMyComp_Export">
                            <input type="checkbox" id="export-create-subfolders">
                            <span class="checkbox-label">åˆæˆåå‰ç¼€</span>
                        </label>
                    </div>
                </div>

                <!-- é€šä¿¡è®¾ç½® -->
                <div class="settings-section">
                    <div class="settings-section-title">é€šä¿¡è®¾ç½®</div>
                    <div class="input-group">
                        <label class="input-option">
                            <span class="input-label">é€šä¿¡ç«¯å£</span>
                            <div class="input-wrapper">
                                <input type="number" id="communication-port" value="8080" min="1024" max="65535">
                                <small class="input-hint">ç«¯å£èŒƒå›´: 1024-65535ï¼Œä¿®æ”¹åéœ€é‡æ–°è¿æ¥</small>
                            </div>
                        </label>
                    </div>
                </div>


            </div>

            <div class="settings-footer">
                <button id="reset-settings-btn" class="btn btn-secondary">é‡ç½®é»˜è®¤</button>
                <button id="save-settings-btn" class="btn btn-primary">ä¿å­˜è®¾ç½®</button>
            </div>
        </div>
    </div>

    <script src="js/CSInterface.js"></script>
    <!-- ç§»é™¤äº†é¡ºåºæ’åˆ—é—´éš”è®¾ç½®å¼¹çª—ï¼Œå› ä¸ºä¸å†æ”¯æŒé¡ºåºæ’åˆ— -->

    <!-- é¡¹ç›®æ—å¤åˆ¶æ¨¡å¼è®¾ç½®å¼¹çª— -->
    <div id="project-adjacent-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>é¡¹ç›®æ—å¤åˆ¶è®¾ç½®</h3>
                <button class="modal-close" onclick="closeProjectAdjacentModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="folder-setting">
                    <div class="folder-preset-section">
                        <select id="project-folder-preset-select">
                            <option value="Eagle_Assets">Eagle_Assets</option>
                            <option value="Eagle_Import">Eagle_Import</option>
                            <option value="Source_Files">Source_Files</option>
                            <option value="Assets">Assets</option>
                            <option value="Import">Import</option>
                            <option value="custom">è‡ªå®šä¹‰...</option>
                        </select>
                    </div>
                    <div class="custom-folder-section">
                        <input type="text" id="project-custom-folder-input" placeholder="æˆ–è¾“å…¥è‡ªå®šä¹‰æ–‡ä»¶å¤¹å">
                    </div>
                </div>
                <div class="modal-description">
                    <p>é€‰æ‹©åœ¨AEé¡¹ç›®æ–‡ä»¶æ—è¾¹åˆ›å»ºçš„æ–‡ä»¶å¤¹åç§°</p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" onclick="closeProjectAdjacentModal()">å–æ¶ˆ</button>
                <button class="modal-btn confirm" onclick="confirmProjectAdjacentSettings()">ç¡®è®¤</button>
            </div>
        </div>
    </div>

    <!-- æŒ‡å®šæ–‡ä»¶å¤¹æ¨¡å¼è®¾ç½®å¼¹çª— -->
    <div id="custom-folder-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>æŒ‡å®šæ–‡ä»¶å¤¹è®¾ç½®</h3>
                <button class="modal-close" onclick="closeCustomFolderModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="folder-path-setting">
                    <div class="folder-path-section">
                        <input type="text" id="custom-folder-path-input" placeholder="é€‰æ‹©ç›®æ ‡æ–‡ä»¶å¤¹è·¯å¾„" readonly>
                        <button class="browse-button" onclick="browseFolderPath()">æµè§ˆ...</button>
                    </div>
                    <div class="recent-folders-section" id="recent-folders-section" style="display: none;">
                        <div class="recent-folders-title">æœ€è¿‘ä½¿ç”¨çš„æ–‡ä»¶å¤¹</div>
                        <div class="recent-folders-list" id="recent-folders-list">
                            <!-- æœ€è¿‘ä½¿ç”¨çš„æ–‡ä»¶å¤¹å°†åŠ¨æ€æ·»åŠ åˆ°è¿™é‡Œ -->
                        </div>
                    </div>
                </div>
                <div class="modal-description">
                    <p>é€‰æ‹©ç´ æå¤åˆ¶çš„ç›®æ ‡æ–‡ä»¶å¤¹è·¯å¾„</p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" onclick="closeCustomFolderModal()">å–æ¶ˆ</button>
                <button class="modal-btn confirm" onclick="confirmCustomFolderSettings()">ç¡®è®¤</button>
            </div>
        </div>
    </div>



    <script>
        // ç§»é™¤äº†sequenceSettingså˜é‡ï¼Œå› ä¸ºä¸å†æ”¯æŒé¡ºåºæ’åˆ—

        // å¯¼å…¥æ¨¡å¼è®¾ç½®
        let projectAdjacentSettings = {
            folderName: 'Eagle_Assets'
        };

        let customFolderSettings = {
            folderPath: '',
            recentFolders: []
        };

        // åŒæ­¥æ“ä½œé¢æ¿å’Œé«˜çº§è®¾ç½®çš„é€‰é¡¹
        function syncQuickToAdvanced() {
            // åŒæ­¥å¯¼å…¥æ¨¡å¼
            const quickImportMode = document.querySelector('input[name="quick-import-mode"]:checked');
            const advancedImportMode = document.querySelector(`input[name="import-mode"][value="${quickImportMode?.value}"]`);
            if (advancedImportMode) {
                advancedImportMode.checked = true;
            }

            // åŒæ­¥å¯¼å…¥è¡Œä¸º - ç›´æ¥åŒæ­¥å¿«é€Ÿé¢æ¿å’Œé«˜çº§è®¾ç½®çš„å¯¼å…¥è¡Œä¸ºæŒ‰é’®
            const quickImportBehavior = document.querySelector('input[name="import-behavior"]:checked');
            if (quickImportBehavior) {
                const advancedImportBehavior = document.querySelector(`input[name="advanced-import-behavior"][value="${quickImportBehavior.value}"]`);
                if (advancedImportBehavior) {
                    advancedImportBehavior.checked = true;
                }
            }
        }

        function syncAdvancedToQuick() {
            // åŒæ­¥å¯¼å…¥æ¨¡å¼
            const advancedImportMode = document.querySelector('input[name="import-mode"]:checked');
            const quickImportMode = document.querySelector(`input[name="quick-import-mode"][value="${advancedImportMode?.value}"]`);
            if (quickImportMode) {
                quickImportMode.checked = true;
            }

            // åŒæ­¥å¯¼å…¥è¡Œä¸º - ç›´æ¥åŒæ­¥é«˜çº§è®¾ç½®å’Œå¿«é€Ÿé¢æ¿çš„å¯¼å…¥è¡Œä¸ºæŒ‰é’®
            const advancedImportBehavior = document.querySelector('input[name="advanced-import-behavior"]:checked');
            if (advancedImportBehavior) {
                const quickImportBehavior = document.querySelector(`input[name="import-behavior"][value="${advancedImportBehavior.value}"]`);
                if (quickImportBehavior) {
                    quickImportBehavior.checked = true;
                }
            }
        }

        // æ¨¡æ€æ¡†æ˜¾ç¤ºé€»è¾‘ç°åœ¨ç”±main.jså¤„ç†ï¼Œé¿å…äº‹ä»¶ç›‘å¬å™¨å†²çª

        // ç§»é™¤äº†sequenceç›¸å…³çš„å‡½æ•°ï¼Œå› ä¸ºä¸å†æ”¯æŒé¡ºåºæ’åˆ—

        // æ•°æ®æŒä¹…åŒ–åŠŸèƒ½
        function saveProjectAdjacentSettings() {
            try {
                localStorage.setItem('ae_extension_project_adjacent_settings', JSON.stringify(projectAdjacentSettings));
            } catch (e) {
                console.warn('æ— æ³•ä¿å­˜é¡¹ç›®æ—å¤åˆ¶è®¾ç½®åˆ°æœ¬åœ°å­˜å‚¨:', e);
            }
        }

        function loadProjectAdjacentSettings() {
            try {
                const saved = localStorage.getItem('ae_extension_project_adjacent_settings');
                if (saved) {
                    const parsed = JSON.parse(saved);
                    projectAdjacentSettings = { ...projectAdjacentSettings, ...parsed };
                }
            } catch (e) {
                console.warn('æ— æ³•ä»æœ¬åœ°å­˜å‚¨åŠ è½½é¡¹ç›®æ—å¤åˆ¶è®¾ç½®:', e);
            }
        }

        function saveCustomFolderSettings() {
            try {
                localStorage.setItem('ae_extension_custom_folder_settings', JSON.stringify(customFolderSettings));
            } catch (e) {
                console.warn('æ— æ³•ä¿å­˜æŒ‡å®šæ–‡ä»¶å¤¹è®¾ç½®åˆ°æœ¬åœ°å­˜å‚¨:', e);
            }
        }

        function loadCustomFolderSettings() {
            try {
                const saved = localStorage.getItem('ae_extension_custom_folder_settings');
                if (saved) {
                    const parsed = JSON.parse(saved);
                    customFolderSettings = { ...customFolderSettings, ...parsed };
                }
            } catch (e) {
                console.warn('æ— æ³•ä»æœ¬åœ°å­˜å‚¨åŠ è½½æŒ‡å®šæ–‡ä»¶å¤¹è®¾ç½®:', e);
            }
        }

        // ä¸‹æ‹‰åˆ—è¡¨å˜åŒ–äº‹ä»¶
        document.addEventListener('DOMContentLoaded', function() {
            const presetSelect = document.getElementById('project-folder-preset-select');
            if (presetSelect) {
                presetSelect.addEventListener('change', function() {
                    const customInput = document.getElementById('project-custom-folder-input');
                    if (this.value === 'custom') {
                        customInput.style.display = 'block';
                        customInput.focus();
                    } else {
                        customInput.style.display = 'none';
                        customInput.value = '';
                    }
                });
            }

            // åŠ è½½è®¾ç½®
            loadProjectAdjacentSettings();
            loadCustomFolderSettings();
            
            // åˆå§‹åŒ–æŒ‡å®šæ–‡ä»¶å¤¹æŒ‰é’®çš„æ‚¬æµ®æç¤º
            setTimeout(() => {
                updateCustomFolderTooltip();
            }, 100);
        });

        // ç‚¹å‡»å¼¹çª—å¤–éƒ¨å…³é—­
        document.addEventListener('click', function(e) {
            const projectModal = document.getElementById('project-adjacent-modal');
            const customModal = document.getElementById('custom-folder-modal');

            if (e.target === projectModal) {
                closeProjectAdjacentModal();
            } else if (e.target === customModal) {
                closeCustomFolderModal();
            }
        });

        // é¡¹ç›®æ—å¤åˆ¶æ¨¡å¼å¼¹çª—åŠŸèƒ½
        function showProjectAdjacentModal() {
            const modal = document.getElementById('project-adjacent-modal');
            const presetSelect = document.getElementById('project-folder-preset-select');
            const customInput = document.getElementById('project-custom-folder-input');

            // è®¾ç½®å½“å‰å€¼
            presetSelect.value = projectAdjacentSettings.folderName;
            customInput.value = '';

            // æ ¹æ®é€‰æ‹©æ˜¾ç¤º/éšè—è‡ªå®šä¹‰è¾“å…¥æ¡†
            customInput.style.display = presetSelect.value === 'custom' ? 'block' : 'none';

            modal.style.display = 'flex';
        }

        function closeProjectAdjacentModal() {
            const modal = document.getElementById('project-adjacent-modal');
            modal.style.display = 'none';

            // å¦‚æœç”¨æˆ·å–æ¶ˆï¼Œæ¢å¤åˆ°ç›´æ¥å¯¼å…¥
            const directRadio = document.querySelector('input[name="import-mode"][value="direct"]');
            if (directRadio) {
                directRadio.checked = true;
            }
        }

        function confirmProjectAdjacentSettings() {
            const presetSelect = document.getElementById('project-folder-preset-select');
            const customInput = document.getElementById('project-custom-folder-input');

            let folderName = '';
            if (presetSelect.value === 'custom') {
                folderName = customInput.value.trim();
                if (!folderName) {
                    alert('è¯·è¾“å…¥è‡ªå®šä¹‰æ–‡ä»¶å¤¹åç§°');
                    return;
                }
            } else {
                folderName = presetSelect.value;
            }

            // éªŒè¯æ–‡ä»¶å¤¹åç§°
            if (!/^[a-zA-Z0-9_\-\u4e00-\u9fa5]+$/.test(folderName)) {
                alert('æ–‡ä»¶å¤¹åç§°åªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ã€ä¸­åˆ’çº¿å’Œä¸­æ–‡å­—ç¬¦');
                return;
            }

            // ä¿å­˜è®¾ç½®
            projectAdjacentSettings.folderName = folderName;

            // å…³é—­å¼¹çª—
            const modal = document.getElementById('project-adjacent-modal');
            modal.style.display = 'none';

            // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
            saveProjectAdjacentSettings();

            console.log('é¡¹ç›®æ—å¤åˆ¶è®¾ç½®å·²ä¿å­˜:', projectAdjacentSettings);
        }

        // æŒ‡å®šæ–‡ä»¶å¤¹æ¨¡å¼å¼¹çª—åŠŸèƒ½
        function showCustomFolderModal() {
            const modal = document.getElementById('custom-folder-modal');
            const pathInput = document.getElementById('custom-folder-path-input');

            // è®¾ç½®å½“å‰å€¼
            pathInput.value = customFolderSettings.folderPath;

            // æ˜¾ç¤ºæœ€è¿‘ä½¿ç”¨çš„æ–‡ä»¶å¤¹
            updateRecentFoldersList();
            
            // æ›´æ–°æ‚¬æµ®æç¤º
            updateCustomFolderTooltip();

            modal.style.display = 'flex';
        }

        function closeCustomFolderModal() {
            const modal = document.getElementById('custom-folder-modal');
            modal.style.display = 'none';

            // å¦‚æœç”¨æˆ·å–æ¶ˆï¼Œæ¢å¤åˆ°ç›´æ¥å¯¼å…¥
            const directRadio = document.querySelector('input[name="import-mode"][value="direct"]');
            if (directRadio) {
                directRadio.checked = true;
            }
        }

        function browseFolderPath() {
            try {
                console.log('æ­£åœ¨ä½¿ç”¨Web APIæ–‡ä»¶å¤¹é€‰æ‹©...');

                // ä¼˜å…ˆä½¿ç”¨ ExtendScript æ–¹æ³•ï¼Œå› ä¸ºå®ƒèƒ½è·å–çœŸå®è·¯å¾„
                if (window.csInterface) {
                    console.log('ä½¿ç”¨ ExtendScript æ–¹æ³•è·å–çœŸå®è·¯å¾„');
                    useExtendScriptFolderPicker('custom-folder-path-input', customFolderSettings.folderPath || '', 'é€‰æ‹©ç›®æ ‡æ–‡ä»¶å¤¹');
                    return;
                }

                // å›é€€æ–¹æ¡ˆ1ï¼šä½¿ç”¨ç°ä»£çš„ File System Access API
                if ('showDirectoryPicker' in window) {
                    console.log('ä½¿ç”¨ File System Access API');
                    showDirectoryPicker()
                        .then(async directoryHandle => {
                            const pathInput = document.getElementById('custom-folder-path-input');
                            
                            // å°è¯•è·å–å®é™…è·¯å¾„ï¼Œå¦‚æœä¸èƒ½è·å–åˆ™ä½¿ç”¨å¥æŸ„
                            let actualPath = '';
                            try {
                                // åœ¨æŸäº›æµè§ˆå™¨ä¸­å¯èƒ½å¯ä»¥è·å–è·¯å¾„
                                if (directoryHandle.getDirectoryHandle) {
                                    actualPath = directoryHandle.name; // è‡³å°‘ä¿å­˜æ–‡ä»¶å¤¹å
                                }
                            } catch (e) {
                                actualPath = directoryHandle.name;
                            }
                            
                            // éªŒè¯è·¯å¾„æ ¼å¼ï¼Œæ‹’ç»ä¿å­˜æ— æ•ˆè·¯å¾„
                            if (!actualPath || actualPath.startsWith('[å·²é€‰æ‹©]')) {
                                console.warn('æ— æ³•è·å–æœ‰æ•ˆè·¯å¾„ï¼Œå›é€€åˆ°ExtendScriptæ–¹æ³•');
                                useExtendScriptFolderPicker('custom-folder-path-input', '', 'é€‰æ‹©ç›®æ ‡æ–‡ä»¶å¤¹');
                                return;
                            }
                            
                            pathInput.value = actualPath;
                            console.log('å·²é€‰æ‹©æ–‡ä»¶å¤¹:', actualPath);

                            // ä¿å­˜æ–‡ä»¶å¤¹ä¿¡æ¯
                            customFolderSettings.directoryHandle = directoryHandle;
                            customFolderSettings.folderPath = actualPath;
                            
                            // åŒæ­¥åˆ°SettingsManager
                            if (window.eagleToAeApp && window.eagleToAeApp.settingsManager) {
                                const currentSettings = window.eagleToAeApp.settingsManager.getSettings();
                                currentSettings.customFolderPath = actualPath;
                                window.eagleToAeApp.settingsManager.saveSettings(currentSettings);
                                console.log('è·¯å¾„å·²åŒæ­¥åˆ°SettingsManager:', actualPath);
                            }
                            // æ›´æ–°æ‚¬æµ®æç¤º
                            updateCustomFolderTooltip();
                        })
                        .catch(error => {
                            if (error.name === 'AbortError') {
                                console.log('ç”¨æˆ·å–æ¶ˆäº†æ–‡ä»¶å¤¹é€‰æ‹©');
                            } else {
                                console.error('File System Access API å¤±è´¥:', error);
                                // å›é€€åˆ° ExtendScript æ–¹æ³•
                                if (window.csInterface) {
                                    useExtendScriptFolderPicker('custom-folder-path-input', '', 'é€‰æ‹©ç›®æ ‡æ–‡ä»¶å¤¹');
                                }
                            }
                        });
                    return;
                }

                // å›é€€æ–¹æ¡ˆ2ï¼šä½¿ç”¨ webkitdirectoryï¼ˆæœ€åé€‰æ‹©ï¼Œå› ä¸ºè·¯å¾„è·å–æœ‰é™ï¼‰
                if (supportsWebkitDirectory()) {
                    console.log('ä½¿ç”¨ webkitdirectory API');
                    useWebkitDirectoryPicker('custom-folder-path-input');
                    return;
                }

                console.warn('æ‰€æœ‰æ–‡ä»¶å¤¹é€‰æ‹©æ–¹æ³•éƒ½ä¸å¯ç”¨');
                alert('æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒæ–‡ä»¶å¤¹é€‰æ‹©åŠŸèƒ½ï¼Œè¯·ä½¿ç”¨è¾ƒæ–°ç‰ˆæœ¬çš„Chromeæˆ–Edgeæµè§ˆå™¨ï¼Œæˆ–ç¡®ä¿AEæ‰©å±•ç¯å¢ƒæ­£å¸¸');
            } catch (error) {
                console.error('æ–‡ä»¶å¤¹é€‰æ‹©å‡ºé”™:', error);
                alert('æ–‡ä»¶å¤¹é€‰æ‹©åŠŸèƒ½å‡ºç°é”™è¯¯: ' + error.message);
            }
        }

        // æ£€æŸ¥æ˜¯å¦æ”¯æŒ webkitdirectory
        function supportsWebkitDirectory() {
            const input = document.createElement('input');
            return 'webkitdirectory' in input;
        }

        // ä½¿ç”¨ webkitdirectory API é€‰æ‹©æ–‡ä»¶å¤¹
        function useWebkitDirectoryPicker(inputId) {
            console.log('ä½¿ç”¨ webkitdirectory é€‰æ‹©æ–‡ä»¶å¤¹...');

            // åˆ›å»ºéšè—çš„æ–‡ä»¶è¾“å…¥å…ƒç´ 
            const input = document.createElement('input');
            input.type = 'file';
            input.webkitdirectory = true;
            input.multiple = true;
            input.style.display = 'none';

            input.addEventListener('change', (event) => {
                const files = event.target.files;
                if (files.length > 0) {
                    // ä»ç¬¬ä¸€ä¸ªæ–‡ä»¶çš„è·¯å¾„ä¸­æå–å®é™…çš„æ–‡ä»¶å¤¹è·¯å¾„
                    const firstFile = files[0];
                    const relativePath = firstFile.webkitRelativePath;
                    
                    // å°è¯•æ„å»ºå®é™…çš„æ–‡ä»¶å¤¹è·¯å¾„
                    let actualFolderPath = '';
                    try {
                        // è·å–æ–‡ä»¶çš„å®Œæ•´è·¯å¾„ï¼Œç„¶åç§»é™¤ç›¸å¯¹è·¯å¾„éƒ¨åˆ†
                        const fullFilePath = firstFile.path || firstFile.webkitRelativePath;
                        if (fullFilePath && relativePath) {
                            // è®¡ç®—çˆ¶æ–‡ä»¶å¤¹è·¯å¾„
                            const pathParts = fullFilePath.split('/');
                            const relativeParts = relativePath.split('/');
                            
                            if (pathParts.length > relativeParts.length) {
                                // ç§»é™¤ç›¸å¯¹è·¯å¾„éƒ¨åˆ†ï¼Œè·å–çˆ¶æ–‡ä»¶å¤¹è·¯å¾„
                                const parentParts = pathParts.slice(0, pathParts.length - relativeParts.length + 1);
                                actualFolderPath = parentParts.join('/');
                            } else {
                                // å›é€€ï¼šä½¿ç”¨æ–‡ä»¶å¤¹åç§°
                                actualFolderPath = relativePath.split('/')[0];
                            }
                        } else {
                            // å›é€€ï¼šä½¿ç”¨é¡¶çº§æ–‡ä»¶å¤¹åç§°
                            actualFolderPath = relativePath.split('/')[0];
                        }
                    } catch (error) {
                        console.warn('æ— æ³•æå–å®é™…è·¯å¾„ï¼Œä½¿ç”¨æ–‡ä»¶å¤¹åç§°:', error);
                        actualFolderPath = relativePath.split('/')[0];
                    }
                    
                    // éªŒè¯è·¯å¾„æ ¼å¼
                    if (!actualFolderPath || actualFolderPath.startsWith('[å·²é€‰æ‹©]')) {
                        console.error('è·å–åˆ°æ— æ•ˆçš„æ–‡ä»¶å¤¹è·¯å¾„ï¼Œå›é€€åˆ°ExtendScriptæ–¹æ³•');
                        if (window.csInterface) {
                            useExtendScriptFolderPicker(inputId, '', 'é€‰æ‹©ç›®æ ‡æ–‡ä»¶å¤¹');
                        } else {
                            alert('æ— æ³•è·å–æœ‰æ•ˆçš„æ–‡ä»¶å¤¹è·¯å¾„ï¼Œè¯·ä½¿ç”¨å…¶ä»–æ–¹æ³•é€‰æ‹©æ–‡ä»¶å¤¹');
                        }
                        document.body.removeChild(input);
                        return;
                    }

                    const pathInput = document.getElementById(inputId);
                    pathInput.value = actualFolderPath;
                    console.log('å·²é€‰æ‹©æ–‡ä»¶å¤¹è·¯å¾„:', actualFolderPath);

                    // ä¿å­˜æ–‡ä»¶å¤¹ä¿¡æ¯
                    if (inputId === 'custom-folder-path-input') {
                        customFolderSettings.folderPath = actualFolderPath;
                        customFolderSettings.files = Array.from(files);
                        
                        // åŒæ­¥åˆ°SettingsManager
                        if (window.eagleToAeApp && window.eagleToAeApp.settingsManager) {
                            const currentSettings = window.eagleToAeApp.settingsManager.getSettings();
                            currentSettings.customFolderPath = actualFolderPath;
                            window.eagleToAeApp.settingsManager.saveSettings(currentSettings);
                            console.log('å¯¼å…¥è·¯å¾„å·²åŒæ­¥åˆ°SettingsManager:', actualFolderPath);
                        }
                        // æ›´æ–°æ‚¬æµ®æç¤º
                        updateCustomFolderTooltip();
                    } else if (inputId === 'export-custom-folder-path-input') {
                        exportCustomFolderSettings.folderPath = actualFolderPath;
                        exportCustomFolderSettings.files = Array.from(files);
                        
                        // åŒæ­¥åˆ°SettingsManager
                        if (window.eagleToAeApp && window.eagleToAeApp.settingsManager) {
                            const currentSettings = window.eagleToAeApp.settingsManager.getSettings();
                            currentSettings.exportSettings.customExportPath = actualFolderPath;
                            window.eagleToAeApp.settingsManager.saveExportSettings(currentSettings.exportSettings);
                            console.log('å¯¼å‡ºè·¯å¾„å·²åŒæ­¥åˆ°SettingsManager:', actualFolderPath);
                        }
                    }
                } else {
                    console.log('ç”¨æˆ·å–æ¶ˆäº†æ–‡ä»¶å¤¹é€‰æ‹©');
                }

                // æ¸…ç†ä¸´æ—¶å…ƒç´ 
                document.body.removeChild(input);
            });

            // æ·»åŠ åˆ°DOMå¹¶è§¦å‘ç‚¹å‡»
            document.body.appendChild(input);
            input.click();
        }

        // CEPæ–‡ä»¶å¤¹é€‰æ‹©çš„é€šç”¨å‡½æ•°
        function useCEPFolderPicker(inputId, currentPath, title) {
            console.log('æ­£åœ¨ä½¿ç”¨CEPæ–‡ä»¶å¤¹é€‰æ‹©å¯¹è¯æ¡†...');

            try {
                // ä½¿ç”¨CSInterfaceçš„æ–‡ä»¶é€‰æ‹©åŠŸèƒ½
                if (window.csInterface) {
                    // ä½¿ç”¨ExtendScriptè°ƒç”¨ç³»ç»Ÿæ–‡ä»¶å¤¹é€‰æ‹©å¯¹è¯æ¡†
                    window.csInterface.evalScript(`
                        try {
                            var folder = Folder.selectDialog("${title || 'é€‰æ‹©å¯¼å‡ºæ–‡ä»¶å¤¹'}", "${currentPath || ''}");
                            if (folder) {
                                JSON.stringify({success: true, path: folder.fsName});
                            } else {
                                JSON.stringify({success: false, cancelled: true});
                            }
                        } catch (error) {
                            JSON.stringify({success: false, error: error.toString()});
                        }
                    `, (result) => {
                        try {
                            const parsed = JSON.parse(result);
                            if (parsed.success && parsed.path) {
                                const selectedPath = parsed.path;
                                const pathInput = document.getElementById(inputId);
                                pathInput.value = selectedPath;
                                console.log('å·²é€‰æ‹©æ–‡ä»¶å¤¹:', selectedPath);

                                // ä¿å­˜è·¯å¾„åˆ°ç›¸åº”çš„è®¾ç½®å¯¹è±¡å¹¶åŒæ­¥åˆ°SettingsManager
                                if (inputId === 'custom-folder-path-input') {
                                    customFolderSettings.folderPath = selectedPath;
                                    // åŒæ­¥åˆ°SettingsManager
                                    if (window.eagleToAeApp && window.eagleToAeApp.settingsManager) {
                                        const currentSettings = window.eagleToAeApp.settingsManager.getSettings();
                                        currentSettings.customFolderPath = selectedPath;
                                        window.eagleToAeApp.settingsManager.saveSettings(currentSettings);
                                        console.log('å¯¼å…¥è·¯å¾„å·²åŒæ­¥åˆ°SettingsManager:', selectedPath);
                                    }
                                    // æ›´æ–°æ‚¬æµ®æç¤º
                                    updateCustomFolderTooltip();
                                } else if (inputId === 'export-custom-folder-path-input') {
                                    exportCustomFolderSettings.folderPath = selectedPath;
                                    // åŒæ­¥åˆ°SettingsManager
                                    if (window.eagleToAeApp && window.eagleToAeApp.settingsManager) {
                                        const currentSettings = window.eagleToAeApp.settingsManager.getSettings();
                                        currentSettings.exportSettings.customExportPath = selectedPath;
                                        window.eagleToAeApp.settingsManager.saveExportSettings(currentSettings.exportSettings);
                                        console.log('å¯¼å‡ºè·¯å¾„å·²åŒæ­¥åˆ°SettingsManager:', selectedPath);
                                    }
                                }

                                // æ›´æ–°tooltipæ˜¾ç¤ºè·¯å¾„
                                updatePathTooltip(inputId, selectedPath);
                            } else if (parsed.cancelled) {
                                console.log('ç”¨æˆ·å–æ¶ˆäº†æ–‡ä»¶å¤¹é€‰æ‹©');
                            } else {
                                console.error('æ–‡ä»¶å¤¹é€‰æ‹©å¤±è´¥:', parsed.error || 'æœªçŸ¥é”™è¯¯');
                            }
                        } catch (parseError) {
                            console.error('è§£ææ–‡ä»¶å¤¹é€‰æ‹©ç»“æœå¤±è´¥:', parseError);
                        }
                    });
                    return;
                }
            } catch (error) {
                console.error('CEPæ–‡ä»¶å¤¹é€‰æ‹©å‡ºé”™:', error);
            }

            // å¦‚æœCEPæ–¹æ³•å¤±è´¥ï¼Œå›é€€åˆ°ExtendScriptæ–¹æ³•
            useExtendScriptFolderPicker(inputId, currentPath, title);
        }

        // ExtendScriptæ–‡ä»¶å¤¹é€‰æ‹©çš„é€šç”¨å‡½æ•°
        function useExtendScriptFolderPicker(inputId, currentPath, title) {
            console.log('æ­£åœ¨ä½¿ç”¨ExtendScriptæ–‡ä»¶å¤¹é€‰æ‹©å¯¹è¯æ¡†...');

            window.csInterface.evalScript(`selectFolder("${currentPath}", "${title}")`, (result) => {
                try {
                    const parsedResult = JSON.parse(result);

                    if (parsedResult.success && parsedResult.path) {
                        const pathInput = document.getElementById(inputId);
                        pathInput.value = parsedResult.path;
                        console.log('å·²é€‰æ‹©æ–‡ä»¶å¤¹:', parsedResult.path);

                        // éªŒè¯è·¯å¾„æ ¼å¼ï¼Œæ‹’ç»ä¿å­˜æ— æ•ˆè·¯å¾„
                        if (parsedResult.path.startsWith('[å·²é€‰æ‹©]')) {
                            console.error('æ£€æµ‹åˆ°æ— æ•ˆè·¯å¾„æ ¼å¼ï¼Œæ‹’ç»ä¿å­˜:', parsedResult.path);
                            alert('è·å–åˆ°æ— æ•ˆçš„æ–‡ä»¶å¤¹è·¯å¾„ï¼Œè¯·é‡æ–°é€‰æ‹©');
                            return;
                        }
                        
                        // ä¿å­˜è·¯å¾„åˆ°ç›¸åº”çš„è®¾ç½®å¯¹è±¡
                        if (inputId === 'custom-folder-path-input') {
                            customFolderSettings.folderPath = parsedResult.path;
                            
                            // åŒæ­¥åˆ°SettingsManager
                            if (window.eagleToAeApp && window.eagleToAeApp.settingsManager) {
                                const currentSettings = window.eagleToAeApp.settingsManager.getSettings();
                                currentSettings.customFolderPath = parsedResult.path;
                                window.eagleToAeApp.settingsManager.saveSettings(currentSettings);
                                console.log('å¯¼å…¥è·¯å¾„å·²åŒæ­¥åˆ°SettingsManager:', parsedResult.path);
                            }
                            // æ›´æ–°æ‚¬æµ®æç¤º
                            updateCustomFolderTooltip();
                        } else if (inputId === 'export-custom-folder-path-input') {
                            exportCustomFolderSettings.folderPath = parsedResult.path;

                            // åŒæ­¥åˆ°SettingsManager
                            if (window.eagleToAeApp && window.eagleToAeApp.settingsManager) {
                                const currentSettings = window.eagleToAeApp.settingsManager.getSettings();
                                currentSettings.exportSettings.customExportPath = parsedResult.path;
                                window.eagleToAeApp.settingsManager.saveExportSettings(currentSettings.exportSettings);
                                console.log('å¯¼å‡ºè·¯å¾„å·²åŒæ­¥åˆ°SettingsManager:', parsedResult.path);
                            }
                        }
                    } else if (parsedResult.cancelled) {
                        console.log('ç”¨æˆ·å–æ¶ˆäº†æ–‡ä»¶å¤¹é€‰æ‹©');
                        // ç”¨æˆ·å–æ¶ˆæ—¶ä¸æ˜¾ç¤ºé”™è¯¯æç¤º
                    } else {
                        console.error('æ–‡ä»¶å¤¹é€‰æ‹©å¤±è´¥:', parsedResult.error || 'æœªçŸ¥é”™è¯¯');
                        // åªæœ‰åœ¨çœŸæ­£å‡ºé”™æ—¶æ‰æ˜¾ç¤ºé”™è¯¯æç¤º
                        alert('æ–‡ä»¶å¤¹é€‰æ‹©å¤±è´¥: ' + (parsedResult.error || 'æœªçŸ¥é”™è¯¯'));
                    }
                } catch (error) {
                    console.error('è§£ææ–‡ä»¶å¤¹é€‰æ‹©ç»“æœå¤±è´¥:', error);
                    alert('æ–‡ä»¶å¤¹é€‰æ‹©åŠŸèƒ½å‡ºç°é”™è¯¯ï¼Œè¯·é‡è¯•');
                }
            });
        }

        // æ›´æ–°è·¯å¾„tooltip
        function updatePathTooltip(inputId, path) {
            const input = document.getElementById(inputId);
            if (input && path) {
                input.title = `å½“å‰è®¾ç½®çš„è·¯å¾„: ${path}`;
                input.setAttribute('data-path', path);
            }

            // å¦‚æœæ˜¯å¯¼å‡ºè‡ªå®šä¹‰æ–‡ä»¶å¤¹ï¼Œæ›´æ–°é€‰é¡¹çš„tooltip
            if (inputId === 'export-custom-folder-path-input') {
                updateExportCustomFolderTooltip(path);
            }
        }

        // æ›´æ–°å¯¼å‡ºè‡ªå®šä¹‰æ–‡ä»¶å¤¹é€‰é¡¹çš„tooltip
        function updateExportCustomFolderTooltip(path) {
            const customFolderOption = document.getElementById('export-custom-folder-option');
            if (customFolderOption) {
                const baseTooltip = 'æŒ‡å®šä»»æ„æ–‡ä»¶å¤¹ä½œä¸ºå¯¼å‡ºç›®å½•';
                if (path && path.trim() !== '') {
                    customFolderOption.title = `${baseTooltip}\nå½“å‰è·¯å¾„: ${path}`;
                } else {
                    customFolderOption.title = `${baseTooltip}\nå½“å‰è·¯å¾„: æœªè®¾ç½®`;
                }
            }
        }

        // å›é€€åˆ°è¾“å…¥å¯¹è¯æ¡†
        function fallbackToInputDialog(type) {
            const currentPath = type === 'å¯¼å…¥' ? customFolderSettings.folderPath : exportCustomFolderSettings.folderPath;
            const selectedPath = prompt(`è¯·è¾“å…¥${type}æ–‡ä»¶å¤¹è·¯å¾„:`, currentPath);
            if (selectedPath !== null && selectedPath.trim() !== '') {
                if (type === 'å¯¼å…¥') {
                    const pathInput = document.getElementById('custom-folder-path-input');
                    pathInput.value = selectedPath.trim();
                } else {
                    const pathInput = document.getElementById('export-custom-folder-path-input');
                    pathInput.value = selectedPath.trim();
                }
            }
        }

        function updateRecentFoldersList() {
            const recentSection = document.getElementById('recent-folders-section');
            const recentList = document.getElementById('recent-folders-list');

            if (customFolderSettings.recentFolders.length > 0) {
                recentSection.style.display = 'block';
                recentList.innerHTML = '';

                customFolderSettings.recentFolders.forEach((folder, index) => {
                    const item = document.createElement('button');
                    item.className = 'recent-folder-item';
                    
                    // åˆ›å»ºæ–‡ä»¶å¤¹è·¯å¾„æ–‡æœ¬
                    const textSpan = document.createElement('span');
                    textSpan.className = 'recent-folder-text';
                    textSpan.textContent = folder;
                    textSpan.title = folder; // æ‚¬æµ®æ˜¾ç¤ºå®Œæ•´è·¯å¾„
                    
                    // åˆ›å»ºåˆ é™¤æŒ‰é’®
                    const deleteBtn = document.createElement('button');
                    deleteBtn.className = 'recent-folder-delete';
                    deleteBtn.textContent = 'Ã—';
                    deleteBtn.title = 'åˆ é™¤æ­¤è®°å½•';
                    deleteBtn.onclick = function(e) {
                        e.stopPropagation(); // é˜»æ­¢äº‹ä»¶å†’æ³¡
                        removeRecentFolder(index);
                    };
                    
                    // ç‚¹å‡»æ–‡ä»¶å¤¹è·¯å¾„é€‰æ‹©è¯¥è·¯å¾„
                    textSpan.onclick = function() {
                        document.getElementById('custom-folder-path-input').value = folder;
                        // æ›´æ–°é€‰ä¸­çŠ¶æ€
                        document.querySelectorAll('.recent-folder-item').forEach(btn => {
                            btn.classList.remove('selected');
                        });
                        item.classList.add('selected');
                    };
                    
                    item.appendChild(textSpan);
                    item.appendChild(deleteBtn);
                    recentList.appendChild(item);
                });
            } else {
                recentSection.style.display = 'none';
            }
        }

        // åˆ é™¤æœ€è¿‘ä½¿ç”¨çš„æ–‡ä»¶å¤¹è®°å½•
        function removeRecentFolder(index) {
            if (index >= 0 && index < customFolderSettings.recentFolders.length) {
                customFolderSettings.recentFolders.splice(index, 1);
                saveCustomFolderSettings();
                updateRecentFoldersList();
                updateCustomFolderTooltip(); // æ›´æ–°æŒ‡å®šæ–‡ä»¶å¤¹æŒ‰é’®çš„æ‚¬æµ®æç¤º
                console.log('å·²åˆ é™¤æœ€è¿‘ä½¿ç”¨çš„æ–‡ä»¶å¤¹è®°å½•ï¼Œç´¢å¼•:', index);
            }
        }

        function confirmCustomFolderSettings() {
            const pathInput = document.getElementById('custom-folder-path-input');
            const folderPath = pathInput.value.trim();

            if (!folderPath) {
                alert('è¯·é€‰æ‹©æ–‡ä»¶å¤¹è·¯å¾„');
                return;
            }

            // ä¿å­˜è®¾ç½®
            customFolderSettings.folderPath = folderPath;

            // æ·»åŠ åˆ°æœ€è¿‘ä½¿ç”¨åˆ—è¡¨
            if (!customFolderSettings.recentFolders.includes(folderPath)) {
                customFolderSettings.recentFolders.unshift(folderPath);
                // é™åˆ¶æœ€è¿‘ä½¿ç”¨åˆ—è¡¨é•¿åº¦
                if (customFolderSettings.recentFolders.length > 5) {
                    customFolderSettings.recentFolders = customFolderSettings.recentFolders.slice(0, 5);
                }
            }

            // å…³é—­å¼¹çª—
            const modal = document.getElementById('custom-folder-modal');
            modal.style.display = 'none';

            // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
            saveCustomFolderSettings();

            console.log('æŒ‡å®šæ–‡ä»¶å¤¹è®¾ç½®å·²ä¿å­˜:', customFolderSettings);
            
            // æ›´æ–°æŒ‡å®šæ–‡ä»¶å¤¹æŒ‰é’®çš„æ‚¬æµ®æç¤º
            updateCustomFolderTooltip();
        }

        // æ›´æ–°æŒ‡å®šæ–‡ä»¶å¤¹æŒ‰é’®çš„æ‚¬æµ®æç¤º
        function updateCustomFolderTooltip() {
            const customFolderOption = document.querySelector('label[title*="å¤åˆ¶åˆ°æŒ‡å®šæ–‡ä»¶å¤¹åå¯¼å…¥"]');
            if (customFolderOption) {
                const baseTooltip = 'å¤åˆ¶åˆ°æŒ‡å®šæ–‡ä»¶å¤¹åå¯¼å…¥';
                const currentPath = customFolderSettings.folderPath;
                if (currentPath && currentPath.trim() !== '') {
                    customFolderOption.title = `${baseTooltip}\nå½“å‰è·¯å¾„: ${currentPath}`;
                } else {
                    customFolderOption.title = `${baseTooltip}\nå½“å‰è·¯å¾„: æœªè®¾ç½®`;
                }
            }
            
            // åŒæ—¶æ›´æ–°å¯¼å‡ºçš„æŒ‡å®šæ–‡ä»¶å¤¹æŒ‰é’®æ‚¬æµ®æç¤º
            const exportCustomFolderOption = document.getElementById('export-custom-folder-option');
            if (exportCustomFolderOption) {
                const baseTooltip = 'å¯¼å‡ºåˆ°æŒ‡å®šæ–‡ä»¶å¤¹ï¼ˆä¸å¯¼å…¥æ¨¡å¼è®¾ç½®ä¸€è‡´ï¼‰';
                const currentPath = customFolderSettings.folderPath;
                if (currentPath && currentPath.trim() !== '') {
                    exportCustomFolderOption.title = `${baseTooltip}\nå½“å‰è·¯å¾„: ${currentPath}`;
                } else {
                    exportCustomFolderOption.title = `${baseTooltip}\nå½“å‰è·¯å¾„: æœªè®¾ç½®`;
                }
            }
        }



        // ESCé”®å…³é—­å¼¹çª—
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                const sequenceModal = document.getElementById('sequence-modal');
                const projectModal = document.getElementById('project-adjacent-modal');
                const customModal = document.getElementById('custom-folder-modal');

                if (sequenceModal.style.display === 'flex') {
                    closeSequenceModal();
                } else if (projectModal.style.display === 'flex') {
                    closeProjectAdjacentModal();
                } else if (customModal.style.display === 'flex') {
                    closeCustomFolderModal();
                }
            }
        });


    </script>

    <!-- æ‹–æ‹½æç¤ºè¦†ç›–å±‚ -->
    <div class="drag-overlay">
        <div class="drag-icon">+</div>
        <div class="drag-text">æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„</div>
    </div>

    <!-- æ¼”ç¤ºæ¨¡å¼æ•°æ®è¦†ç›–ç­–ç•¥ (å¿…é¡»åœ¨æ‰€æœ‰å…¶ä»–è„šæœ¬ä¹‹å‰) -->
    <script src="js/demo/demo-override.js"></script>

    <script src="js/CSInterface.js"></script>
    <script src="js/websocket-client.js"></script>
    <script src="js/constants/ImportSettings.js"></script>
    <script src="js/services/SettingsManager.js"></script>
    <script src="js/services/FileHandler.js"></script>
    <script src="js/services/PortDiscovery.js"></script>
    <script src="js/utils/SoundPlayer.js"></script>
    <script src="js/utils/LogManager.js"></script>
    <script src="js/cep-debug.js"></script>
    <script src="js/nodejs-test.js"></script>

    <!-- æ¼”ç¤ºæ¨¡å¼è„šæœ¬ -->
    <script src="js/demo/demo-apis.js"></script>
    <script src="js/demo/demo-network-interceptor.js"></script>
    <script src="js/demo/demo-ui.js"></script>
    <script src="js/demo/easter-egg.js"></script>
    <script src="js/demo/demo-mode.js"></script>
    <!-- <script src="js/demo/demo-validation.js"></script> -->

    <script src="js/main.js"></script>

    <script>
        // åˆå§‹åŒ– CSInterface ç”¨äºå¼¹çª—ä¸­çš„æ–‡ä»¶å¤¹é€‰æ‹©
        if (typeof CSInterface !== 'undefined') {
            window.csInterface = new CSInterface();
        }

        // æ‰‹åŠ¨ä¿®å¤titleï¼ˆå¤‡ç”¨ï¼‰
        window.fixTitles = function() {
            if (!window.__DEMO_DATA__) return;

            const aeData = window.__DEMO_DATA__.ae.connected;
            const eagleData = window.__DEMO_DATA__.eagle.connected;

            const projectPath = document.getElementById('project-path');
            const eaglePath = document.getElementById('eagle-path');
            const eagleLibrary = document.getElementById('eagle-library');

            if (projectPath && aeData.projectPath) {
                projectPath.removeAttribute('title');
                projectPath.setAttribute('title', aeData.projectPath);
                projectPath.title = aeData.projectPath;
                console.log('âœ… AEè·¯å¾„titleå·²ä¿®å¤:', aeData.projectPath);
            }

            if (eaglePath && eagleData.execPath) {
                eaglePath.removeAttribute('title');
                eaglePath.setAttribute('title', eagleData.execPath);
                eaglePath.title = eagleData.execPath;
                console.log('âœ… Eagleè·¯å¾„titleå·²ä¿®å¤:', eagleData.execPath);
            }

            if (eagleLibrary && eagleData.libraryPath) {
                eagleLibrary.removeAttribute('title');
                eagleLibrary.setAttribute('title', eagleData.libraryPath);
                eagleLibrary.title = eagleData.libraryPath;
                console.log('âœ… èµ„æºåº“titleå·²ä¿®å¤:', eagleData.libraryPath);
            }
        };

        // æ·»åŠ è°ƒè¯•åŠŸèƒ½
        window.debugTitle = function() {
            console.log('=== Titleè°ƒè¯•ä¿¡æ¯ ===');

            // æ£€æŸ¥æ¼”ç¤ºæ¨¡å¼çŠ¶æ€
            console.log('æ¼”ç¤ºæ¨¡å¼çŠ¶æ€:');
            console.log('  __DEMO_MODE_ACTIVE__:', window.__DEMO_MODE_ACTIVE__);
            console.log('  __DEMO_DATA__å­˜åœ¨:', !!window.__DEMO_DATA__);
            console.log('  demoMode.isActive:', window.demoMode?.isActive);

            if (window.__DEMO_DATA__) {
                const aeData = window.__DEMO_DATA__.ae.connected;
                const eagleData = window.__DEMO_DATA__.eagle.connected;
                console.log('AEæ¼”ç¤ºæ•°æ®:', aeData);
                console.log('Eagleæ¼”ç¤ºæ•°æ®:', eagleData);
            }

            // æ£€æŸ¥titleå±æ€§
            console.log('\nTitleå±æ€§æ£€æŸ¥:');
            const elements = [
                { id: 'project-path', name: 'AEè·¯å¾„' },
                { id: 'eagle-path', name: 'Eagleè·¯å¾„' },
                { id: 'eagle-library', name: 'èµ„æºåº“' }
            ];

            elements.forEach(({ id, name }) => {
                const element = document.getElementById(id);
                if (element) {
                    const textContent = element.textContent || '';
                    const title = element.title || '';
                    console.log(`${name} (${id}):`);
                    console.log(`  æ–‡æœ¬å†…å®¹: "${textContent}"`);
                    console.log(`  titleå±æ€§: "${title}"`);
                    console.log(`  titleç±»å‹: ${typeof title}`);
                    console.log(`  titleé•¿åº¦: ${title.length}`);

                    if (title === 'undefined') {
                        console.error(`âš ï¸ ${name}çš„titleä¸ºundefinedï¼`);
                    }
                } else {
                    console.error(`âŒ å…ƒç´ ${id}ä¸å­˜åœ¨`);
                }
            });

            console.log('=== è°ƒè¯•å®Œæˆ ===');
            console.log('åœ¨æ§åˆ¶å°ä¸­æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯');
        };

        // å…¨å±€æ—¥å¿—æ§åˆ¶ - è®¾ç½®ä¸º false æ¥ç®€åŒ–æ¼”ç¤ºæ¨¡å¼æ—¥å¿—
        window.DEMO_QUIET_MODE = true;

        // é‡å†™consoleæ–¹æ³•æ¥è¿‡æ»¤æ¼”ç¤ºæ¨¡å¼æ—¥å¿—
        if (window.DEMO_QUIET_MODE) {
            const originalLog = console.log;
            const originalError = console.error;

            console.log = function(...args) {
                const message = args.join(' ');
                // è¿‡æ»¤æ¼”ç¤ºæ¨¡å¼ç›¸å…³çš„æ—¥å¿—
                if (message.includes('ğŸ­') || message.includes('ğŸ”') || message.includes('ğŸ“‹') ||
                    message.includes('ğŸ›¡ï¸') || message.includes('ğŸ’¾') || message.includes('ğŸ”„') ||
                    message.includes('ğŸ¨') || message.includes('ğŸ§©') || message.includes('ğŸ¯') ||
                    message.includes('ğŸ“Š') || message.includes('ğŸ”—') || message.includes('ğŸ–±ï¸') ||
                    message.includes('âœ…') || message.includes('âš ï¸') || message.includes('ğŸ‘‚') ||
                    message.includes('æ¼”ç¤ºæ¨¡å¼') || message.includes('æ¼”ç¤ºæ•°æ®') ||
                    message.includes('ç½‘ç»œæ‹¦æˆª') || message.includes('DOMå…ƒç´ ') ||
                    message.includes('æ¼”ç¤ºUI') || message.includes('æ¼”ç¤ºAPI') ||
                    message.includes('é…ç½®åŠ è½½å¤±è´¥') || message.includes('é»˜è®¤é…ç½®') ||
                    message.includes('æ•°æ®è¦†ç›–') || message.includes('ç¼“å­˜DOM') ||
                    message.includes('è¿æ¥æŒ‰é’®') || message.includes('çŠ¶æ€æŒ‡ç¤ºå™¨') ||
                    message.includes('äº‹ä»¶ç›‘å¬å™¨') || message.includes('APIå·²è¢«æ‹¦æˆª') ||
                    message.includes('å¤‡ä»½åŸå§‹') || message.includes('å·²æ›¿æ¢ä¸º') ||
                    message.includes('Webç¯å¢ƒ') || message.includes('CSInterfaceå­˜åœ¨ä½†è°ƒç”¨å¤±è´¥') ||
                    message.includes('ğŸ“¡ å·²å‘Eagleæ‰©å±•') || message.includes('å¹¿æ’­AEç«¯å£ä¿¡æ¯') ||
                    message.includes('æœªè¿æ¥åˆ°Eagleï¼Œè·³è¿‡ä¸´æ—¶æ–‡ä»¶å¤¹æ£€æŸ¥')) {
                    return; // ä¸è¾“å‡ºæ¼”ç¤ºæ¨¡å¼ç›¸å…³æ—¥å¿—
                }
                originalLog.apply(console, args);
            };

            console.error = function(...args) {
                const message = args.join(' ');
                // è¿‡æ»¤Webç¯å¢ƒä¸‹çš„é¢„æœŸé”™è¯¯
                if (message.includes('é…ç½®åŠ è½½å¤±è´¥') ||
                    message.includes('Failed to fetch') ||
                    message.includes('è·å–AEç‰ˆæœ¬å¤±è´¥') ||
                    message.includes('getHostEnvironment') ||
                    message.includes('createMockCSInterface') ||
                    message.includes('Cannot read properties of undefined') ||
                    message.includes('Cannot read properties of null')) {
                    return; // ä¸è¾“å‡ºWebç¯å¢ƒä¸‹çš„é¢„æœŸé”™è¯¯
                }
                originalError.apply(console, args);
            };
        }

        // é¡µé¢åŠ è½½å®Œæˆ
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ“„ é¡µé¢åŠ è½½å®Œæˆ');

            // å»¶è¿Ÿæ‰§è¡ŒNode.jsæ£€æµ‹ï¼Œç¡®ä¿CEPç¯å¢ƒå®Œå…¨åˆå§‹åŒ–
            setTimeout(function() {
                console.log('ğŸ”„ é‡æ–°æ£€æµ‹Node.jsç¯å¢ƒ...');

                // å°è¯•å¤šç§æ–¹å¼æ£€æµ‹Node.js
                let nodeDetected = false;

                // æ–¹æ³•1: æ£€æŸ¥window.cep_node
                if (window.cep_node && window.cep_node.require) {
                    console.log('âœ… é€šè¿‡cep_nodeæ£€æµ‹åˆ°Node.js');
                    window.require = window.cep_node.require;
                    window.process = window.cep_node.process;
                    window.Buffer = window.cep_node.Buffer;
                    nodeDetected = true;
                }

                // æ–¹æ³•2: æ£€æŸ¥å…¨å±€require
                if (!nodeDetected && typeof require !== 'undefined') {
                    console.log('âœ… æ£€æµ‹åˆ°å…¨å±€require');
                    try {
                        const testOs = require('os');
                        if (testOs) {
                            window.require = require;
                            nodeDetected = true;
                        }
                    } catch (e) {
                        console.warn('å…¨å±€requireæµ‹è¯•å¤±è´¥:', e.message);
                    }
                }

                // æ–¹æ³•3: å°è¯•é€šè¿‡evalæ‰§è¡ŒNode.jsä»£ç 
                if (!nodeDetected) {
                    try {
                        eval('if (typeof require !== "undefined") { window.require = require; window.__NODE_EVAL_SUCCESS__ = true; }');
                        if (window.__NODE_EVAL_SUCCESS__) {
                            console.log('âœ… é€šè¿‡evalæ£€æµ‹åˆ°Node.js');
                            nodeDetected = true;
                        }
                    } catch (e) {
                        console.warn('evalæ£€æµ‹å¤±è´¥:', e.message);
                    }
                }

                // æ›´æ–°å…¨å±€æ ‡å¿—
                window.__NODE_JS_AVAILABLE__ = nodeDetected;

                if (nodeDetected) {
                    console.log('ğŸ‰ Node.jsç¯å¢ƒæ£€æµ‹æˆåŠŸï¼');
                    if (window.process && window.process.version) {
                        console.log('Node.jsç‰ˆæœ¬:', window.process.version);
                    }
                } else {
                    console.error('âŒ Node.jsç¯å¢ƒæ£€æµ‹å¤±è´¥');
                    console.log('è¯·æ£€æŸ¥manifest.xmlé…ç½®å’ŒAfter Effectsç‰ˆæœ¬');
                }
            }, 1000); // å»¶è¿Ÿ1ç§’æ‰§è¡Œ
        });

        // æ ‡é¢˜å­—ç¬¦å˜æ¢å¤„ç† - é¿å…CSS hoverå†²çª
        document.addEventListener('DOMContentLoaded', function() {
            const titleElement = document.querySelector('.title');
            const charA1 = document.querySelector('.char-a1');
            
            if (titleElement && charA1) {
                // ç¡®ä¿åˆå§‹çŠ¶æ€ä¸ºå°å†™a
                charA1.textContent = 'a';
                charA1.classList.remove('uppercase');
                
                let isHovered = false;
                let hoverTimeout = null;
                let leaveTimeout = null;
                
                titleElement.addEventListener('mouseenter', function(e) {
                    clearTimeout(leaveTimeout);
                    isHovered = true;
                    charA1.classList.add('uppercase');
                    
                    hoverTimeout = setTimeout(() => {
                        if (isHovered) {
                            charA1.textContent = 'A';
                        }
                    }, 100);
                });
                
                titleElement.addEventListener('mouseleave', function(e) {
                    clearTimeout(hoverTimeout);
                    isHovered = false;
                    charA1.classList.remove('uppercase');
                    
                    leaveTimeout = setTimeout(() => {
                        if (!isHovered) {
                            charA1.textContent = 'a';
                        }
                    }, 50);
                });
                
                // ç›‘å¬å…¨å±€é¼ æ ‡ç§»åŠ¨ï¼Œæ£€æµ‹æ˜¯å¦çœŸæ­£ç¦»å¼€æ ‡é¢˜åŒºåŸŸ
                document.addEventListener('mousemove', function(e) {
                    const rect = titleElement.getBoundingClientRect();
                    const isInside = e.clientX >= rect.left && e.clientX <= rect.right && 
                                   e.clientY >= rect.top && e.clientY <= rect.bottom;
                    
                    if (isInside && !isHovered) {
                        clearTimeout(leaveTimeout);
                        isHovered = true;
                        charA1.classList.add('uppercase');
                        
                        hoverTimeout = setTimeout(() => {
                            if (isHovered) {
                                charA1.textContent = 'A';
                            }
                        }, 100);
                    } else if (!isInside && isHovered) {
                        clearTimeout(hoverTimeout);
                        isHovered = false;
                        charA1.classList.remove('uppercase');
                        
                        leaveTimeout = setTimeout(() => {
                            if (!isHovered) {
                                charA1.textContent = 'a';
                            }
                        }, 50);
                    }
                });
                
                // å¼ºåˆ¶é‡ç½®å‡½æ•°
                window.resetTitleChar = function() {
                    clearTimeout(hoverTimeout);
                    clearTimeout(leaveTimeout);
                    charA1.textContent = 'a';
                    charA1.classList.remove('uppercase');
                    isHovered = false;
                };
            }
        });
    </script>
</body>
</html>
