(()=>{let i=chrome||browser;if(eagle.env.isBackground()){let n,s=[],r,l;i.runtime.onMessage.addListener((e,a,t)=>{return"batch-save-iframe"===e.channel?(s=[],n=t,i.tabs.query({active:!0,currentWindow:!0},e=>{l=setTimeout(()=>{n&&(n({}),n=void 0)},2e3),i.tabs.sendMessage(e[0].id,{channel:"batch-save-iframe"},e=>{clearTimeout(l)})}),!0):"batch-save-iframe-response"===e.channel?((t=e.data)&&0<t.length&&s.push(t),clearTimeout(r),r=setTimeout(()=>{n&&n({data:s}),s=[],n=void 0},500),!0):void 0})}else(async()=>{class n{async getCollectableItems(){var e,a=await eagle.elementCollector.getCollectableItems();for(e of a){var t=await eagle.elementInspector.getMeta(e.element);e.elementMeta=t,delete e.element}return a}}window.self!==window.top&&jQuery(document).ready(e=>{i.runtime.onMessage.addListener((e,a,t)=>{if("batch-save-iframe"===e.channel)return(async()=>{var e=await(new n).getCollectableItems();i.runtime.sendMessage({channel:"batch-save-iframe-response",data:e})})(),t(),!0})})})()})();