class I18n{#onChangedCallback=[];languageMap={zh:"zh-CN","zh-tw":"zh-TW","zh-cn":"zh-CN",es:"es",de:"de",ru:"ru",ja:"ja",ko:"ko",en:"en"};words={};loadedLocale="";async init(){await this.#initLocale(),this.#registerRuntimeChannel()}async#initLocale(e=null){var e=e||this.#getLocaleFromPreference(),a=eagle.runtime.getURL(`locales/${e}.json`);this.words=await fetch(encodeURI(a)).then(e=>e.json()).catch(e=>{}),this.loadedLocale=e}async update(n=null){return new Promise(async e=>{let a=n||this.#getLocaleFromPreference();a!==this.loadedLocale&&("browser"==a&&(a=this.#getLocaleFromPreference()),await this.#initLocale(a)),e()})}getLocales(){return{"zh-CN":"简体中文","zh-TW":"繁體中文",en:"English",es:"Español",de:"Deutsch",ru:"Русский",ja:"日本語",ko:"한국어"}}#getLocaleFromPreference(){var e=navigator.language.toLowerCase(),a=eagle.preference.overrideLocale.toLowerCase();return a&&"browser"!==a?this.languageMap[a]||"en":this.languageMap[e]||this.languageMap[e.split("-")[0]]||"en"}changed(e){this.#onChangedCallback.push(e)}#registerRuntimeChannel(){eagle.preference.changed(async({dirty:e})=>{e.locale&&(await this.update(eagle.preference.overrideLocale),this.#onChangedCallback.forEach(e=>e()))})}}eagle.i18n=new I18n;