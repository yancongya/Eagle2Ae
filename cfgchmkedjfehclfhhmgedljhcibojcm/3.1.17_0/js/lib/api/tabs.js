class BaseTabs{sendMessage(e,r,t=0,s){throw new Error("No implementation for sendMessage")}query(e){throw new Error("No implementation for query")}executeScript(e,r){throw new Error("No implementation for executeScript")}captureVisibleTab(e,r){throw new Error("No implementation for captureVisibleTab")}create(e){throw new Error("No implementation for create")}}class ChromeTabs extends BaseTabs{sendMessage(e,r,t={},s=()=>{}){chrome.tabs.sendMessage(e,{channel:r,...t},s)}query(t){return new Promise((r,e)=>{chrome.tabs.query(t,e=>{r(e)})})}executeScript(t,s){return new Promise((r,e)=>{chrome.tabs.executeScript(t,s,e=>{r(e)})})}captureVisibleTab(t,s){return new Promise((r,e)=>{chrome.tabs.captureVisibleTab(t,s,e=>{r(e)})})}create(t){return new Promise((r,e)=>{chrome.tabs.create(t,e=>{r(e)})})}}class BrowserTabs extends BaseTabs{sendMessage(e,r,t={},s=()=>{}){browser.tabs.sendMessage(e,{channel:r,...t},s)}query(e){return browser.tabs.query(e)}executeScript(e,r){return browser.tabs.executeScript(e,r)}captureVisibleTab(e,r){return browser.tabs.captureVisibleTab(e,r)}create(e){return browser.tabs.create(e)}}class ForegroundTabs{sendMessage(e,r,t,s){return eagle.runtime.sendMessage("tabs",{action:"sendMessage",tabId:e,channel:r,params:t,responseCallback:s})}query(e){return eagle.runtime.sendMessage("tabs",{action:"query",queryObj:e})}executeScript(e,r){return eagle.runtime.sendMessage("tabs",{action:"executeScript",tabId:e,details:r})}captureVisibleTab(e,r){return eagle.runtime.sendMessage("tabs",{action:"captureVisibleTab",windowId:e,options:r})}create(e){return eagle.runtime.sendMessage("tabs",{action:"create",createProperties:e})}async getCurrentTab(){return eagle.runtime.sendMessage("tabs",{action:"getCurrentTab"})}}class BackgroundTabs{tabs=null;constructor(){if("undefined"!=typeof browser&&void 0!==browser.runtime)this.tabs=new BrowserTabs;else{if("undefined"==typeof chrome||!chrome.tabs)throw new Error("BrowserAPI: No tabs found.");this.tabs=new ChromeTabs}eagle.runtime.onMessage("tabs",async(e,r,t)=>{var s,a,n,i;return"sendMessage"==e.action&&({tabId:n,channel:i,params:s,responseCallback:a}=e,this.sendMessage(n,i,s,a)),"query"==e.action&&(n=e["queryObj"],t(await this.query(n))),"executeScript"==e.action&&({tabId:i,details:s}=e,t(await this.executeScript(i,s))),"captureVisibleTab"==e.action&&({windowId:a,options:n}=e,t(await this.captureVisibleTab(a,n))),"create"==e.action&&(i=e["createProperties"],t(await this.create(i))),!0})}sendMessage(e,r,t={},s){return this.tabs.sendMessage(e,r,t,s)}query(e){return this.tabs.query(e)}executeScript(e,r){return this.tabs.executeScript(e,r)}captureVisibleTab(e,r){return this.tabs.captureVisibleTab(e,r)}create(e){return this.tabs.create(e)}async getCurrentTab(){return new Promise(async(e,r)=>{var[t]=await this.query({active:!0,currentWindow:!0});return t?e(t):r(new Error("No active tab found."))})}}class Tabs{tabs=null;constructor(){eagle.env.isBackground()?this.tabs=new BackgroundTabs:this.tabs=new ForegroundTabs}sendMessage(e,r,t={},s){return this.tabs.sendMessage(e,r,t,s)}query(e){return this.tabs.query(e)}executeScript(e,r){return this.tabs.executeScript(e,r)}captureVisibleTab(e,r){return this.tabs.captureVisibleTab(e,r)}create(e){return this.tabs.create(e)}async getCurrentTab(){return this.tabs.getCurrentTab()}}eagle.tabs=new Tabs;