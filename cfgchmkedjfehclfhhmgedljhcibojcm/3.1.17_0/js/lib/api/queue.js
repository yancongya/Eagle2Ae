class Queue{constructor(t,e){this.worker=t,this.concurrency=e,this.taskQueue=[],this.activeCount=0,this.drainCallback=null}push(t){this.taskQueue.push(t),this.next()}drain(t){this.drainCallback=t,0===this.activeCount&&0===this.taskQueue.length&&this.drainCallback()}next(){var t;this.activeCount<this.concurrency&&0<this.taskQueue.length&&(t=this.taskQueue.shift(),this.activeCount++,this.worker(t,async t=>{this.activeCount--,this.next(),0===this.activeCount&&0===this.taskQueue.length&&this.drainCallback&&this.drainCallback()}))}}eagle.Queue=Queue;