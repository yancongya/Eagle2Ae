class Utils{throttle(e,t,i,r){new Date;function a(){l=n,e.apply(s,h)}var n,o,s,h,d=0,l=0,u=null;return function(){n=+new Date,s=this,h=arguments,o=n-(r?d:l)-t,clearTimeout(u),r?i?u=setTimeout(a,t):0<=o&&a():0<=o?a():i&&(u=setTimeout(a,-o)),d=n}}debounce(r,a,n){var o;return function(){var e=this,t=arguments,i=n&&!o;clearTimeout(o),o=setTimeout(function(){o=null,n||r.apply(e,t)},a),i&&r.apply(e,t)}}clearWeirdCharacters(e){return null==e?"":e.replace(/^\.+/,"").replace(/(?![*#0-9]+)[\p{Emoji}\p{Emoji_Modifier}\p{Emoji_Component}\p{Emoji_Modifier_Base}\p{Emoji_Presentation}]/gu,"").replace(/[#$%^&*<>:'"/\\|?*]+/g,"").replace(/\p{Emoji_Presentation}|\p{Extended_Pictographic}|([0-9]\u{FE0F}\u{20E3})|([*#\u{1F51F}]\u{FE0F}\u{20E3})/gmu,"").replace("\ud83d","").replace("Ô∏è","")}avoidLongFileName(e){return eagle.env.appInfo.isVersion4?e.substr(0,255):e.substr(0,65)}clearWeirdCharactersAndAvoidLongFileName(e){return this.avoidLongFileName(this.clearWeirdCharacters(e))}isValidUrl(e){return/^(?:(?:https?|ftp):\/\/)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/\S*)?$/i.test(e)}absolutePath(e){if(e){if(-1<e.indexOf("data:image"))return e;if(e.startsWith("blob:"))return e;e&&-1<e.indexOf(" ")&&(e=e.trim().split(" ")[0]);var t=document.createElement("a");return t.href=e,t.href}}urlToBase64(a,n=700){return new Promise(t=>{a.startsWith("//")&&(a="https:"+a);let i=new XMLHttpRequest,r=!1;var e=-1<a.toLowerCase().indexOf(".mp4")||-1<a.toLowerCase().indexOf(".webm");-1<a.toLowerCase().indexOf(".gif")&&(n=1200),e?t(void 0):(i.onload=function(){clearTimeout(n);let e=new FileReader;e.onloadend=function(){r||(r=!0,-1<e.result.indexOf("data:image")?t(e.result):t(void 0))},e.readAsDataURL(i.response)},i.open("GET",a),i.responseType="blob",i.send(),n=setTimeout(()=>{r||(r=!0,i.abort(),t(void 0))},n))})}deepUnique(i){return i.sort().filter((e,t)=>JSON.stringify(e)!==JSON.stringify(i[t-1]))}imageLoaded(t){return new Promise(e=>{t.complete?e(!0):(t.addEventListener("load",()=>{e(!0)}),t.addEventListener("error",()=>{e(!1)}))})}getElementDimensions(e){let t={width:0,height:0};var i=e?.tagName?.toLowerCase();return i&&((t="video"===i?{width:e.videoWidth||e.width,height:e.videoHeight||e.height}:"svg"===i||"audio"===i?{width:e.clientWidth,height:e.clientHeight}:{width:e.naturalWidth||e.width,height:e.naturalHeight||e.height}).width=parseInt(t.width),t.height=parseInt(t.height)),t}getURLDimensions(i){return new Promise(e=>{const t=new Image;t.src=i,t.onload=()=>{e({width:t.width,height:t.height})},t.onerror=()=>{e({width:0,height:0})}})}async resizeBase64ImageToMaxSize(e,a=720){return new Promise(i=>{let r=new Image;r.onload=function(){var e=document.createElement("canvas");r.width>a?(e.width=a,e.height=parseInt(a*r.height/r.width)):(e.width=r.width,e.height=r.height);e.getContext("2d").drawImage(r,0,0,e.width,e.height);var t=e.toDataURL();eagle.logger.info(`saveURL, base64[${t.length}]`),i({width:e.width,height:e.height,base64:t})},r.onerror=()=>{i()},r.src=e})}async sleep(t){return new Promise(e=>{setTimeout(()=>{e()},t)})}deepClone(e){return JSON.parse(JSON.stringify(e))}raceAbort(n){return new Promise((t,i)=>{const r=new AbortController,a=r["signal"];var e=n.map(i=>new Promise((e,t)=>{i(a).then(e).catch(t)}));Promise.race(e).then(e=>{r.abort(),t(e)}).catch(e=>{r.abort(),i(e)})})}}eagle.utils=new Utils;class TreeUtil{walk(t,i,r,a=null,n=0){if(void 0===t&&(t=[]),Array.isArray(t))for(let e=0;e<t.length;e++)this.walk(t[e],i,r,a,n);else r(t,a,n),t[i]&&this.walk(t[i],i,r,t,n+1)}depth(e,t){let r=0;return this.walk(e,t,(e,t,i)=>{i>r&&(r=i)}),r}}eagle.utils.tree=new TreeUtil;class URLUtil{isSameHost(e,t){return new URL(e).host===new URL(t).host}isSameRootDomain(e,t){return this.getRootDomain(e)===this.getRootDomain(t)}getRootDomain(e){return new URL(e).host.split(".").slice(-2).join(".")}}eagle.utils.url=new URLUtil;