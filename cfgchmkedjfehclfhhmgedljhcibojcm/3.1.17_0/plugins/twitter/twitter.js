class TwitterPlugin extends SitePlugin{disableBatchSaver=!0;inject(){setInterval(()=>{this.makeVideoElementCollectable()},500)}makeVideoElementCollectable(){document.querySelectorAll("video:not([eagle-collectable])").forEach((e,t)=>{e.setAttribute("eagle-collectable","true")})}getMeta(e){var t,i,r={};return(location.href.includes("twitter.com")||location.href.includes("x.com"))&&(e=e.closest("article"))&&((t=e.querySelector("a[href]"))&&(t=t.getAttribute("href").replace("/",""),i=e.querySelector('div[dir="auto"]'),r.customTitle=i?`@${t} `+i.innerText:"@"+t),i=e.querySelector('a[href*="/status/"]'))&&(r.link=i.href),r}async getMetaAsync(e){async function t(e,t){var i=`https://${location.hostname}/i/api/2/timeline/conversation/${e}.json?tweet_mode=extended&include_entities=false&include_user_entities=false`,r=function(e){let r={};return document.cookie.split(";").filter(e=>0<e.indexOf("=")).forEach(e=>{e.replace(/^([^=]+)=(.+)$/,(e,t,i)=>{r[t.trim()]=i.trim()})}),e?r[e]:r}(),r={authorization:"Bearer AAAAAAAAAAAAAAAAAAAAANRILgAAAAAAnNwIzUejRCOuH5E6I8xnZz4puTs%3D1Zv7ttfk8LF81IUq16cHjhLTvJu4FA33AGWWjCpTnA","x-twitter-active-user":"yes","x-twitter-client-language":r.lang,"x-csrf-token":r.ct0},t=t.getAttribute("poster").split("/"),a=t[t.length-1].split(".")[0],t=await(await fetch(i,{headers:r})).json(),i=t.globalObjects.tweets;if(t.errors)return{};if(!i)return{};if(!i[e])return{};r=i[e];if(r.extended_entities&&r.extended_entities.media)for(var n of r.extended_entities.media){if("video"==n.type&&n.media_url.includes(a)){let e=n.video_info.variants;return{src:(e=(e=e.filter(e=>e.bitrate&&"video/mp4"==e.content_type)).sort((e,t)=>e.bitrate>t.bitrate?-1:1))[0].url}}if("video"==n.type&&n.video_info.variants){let e=n.video_info.variants;return{src:(e=(e=e.filter(e=>e.bitrate&&"video/mp4"==e.content_type)).sort((e,t)=>e.bitrate>t.bitrate?-1:1))[0].url}}}}if(location.href.startsWith("https://twitter.com")||location.href.startsWith("https://x.com")){var i=e.closest("a");if(!i){i=e?.closest("article")?.querySelector('a[href$="/retweets"],a[href$="/analytics"],a[href*="/status/"]');if(i){e=e?.closest("article")?.querySelector("video");if(e&&!(-1<e.currentSrc.indexOf(".mp4"))){i=i.getAttribute("href").split("/")[3];if(i)try{return await t(i,e)}catch(e){}}}}}return{}}}(()=>{var e=new TwitterPlugin;eagle.plugin.register("twitter.com",e),eagle.plugin.register("x.com",e),e.inject()})();